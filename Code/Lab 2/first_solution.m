function [u_opt, x_opt, ...
    psi_opt, functional_min, ...
    switches] ...
= first_solution ( ...
    T, k_1, k_2, L, S, epsilon, alpha, ...                            % parameters of initial task
    delta, ...                                                        % user's parameters
    number_of_points_for_splitting, number_of_points_for_enum, ...
    trimmer) ...                                                      % auxiliary parameters
    
functional_min = Inf;

switches = [];

if (S + epsilon + delta < 0)
    return;
end

fsolve_opts = optimoptions('fsolve', 'Display','none');

t_opt = linspace(0, T, number_of_points_for_splitting);

if (abs(S) <= epsilon + delta && T >= max((L + epsilon + delta) ./ k_1, (L - epsilon - delta) ./ k_2))
    
    u1_opt = zeros(1, number_of_points_for_splitting);
    x2_opt = zeros(1, number_of_points_for_splitting);
    
    psi1_opt = zeros(1, number_of_points_for_splitting);
    psi2_opt = zeros(1, number_of_points_for_splitting);
    
    if (L - epsilon - delta <= k_1 * T && k_1 * T <= L + epsilon + delta)
        u2_opt = k_1 .* ones(1, number_of_points_for_splitting);
        x1_opt = k_1 .* t_opt;
    else
        if (L - epsilon - delta <= k_2 * T && k_2 * T <= L + epsilon + delta)
            u2_opt = k_2 .* ones(1, number_of_points_for_splitting);
            x1_opt = k_2 .* t_opt;
        else
            u2_opt = L ./ T .* ones(1, number_of_points_for_splitting);
            x1_opt = L ./ T .* t_opt;
        end
    end
    functional_min = 0;
else
    if (S - epsilon >= 0)
        
        % first_case: psi_1 = 0, psi_2_0 > alpha
        
        psi1_cur = 0;
        u2_cur = k_2;
        
        psi_2_t_0 = @(t, psi_2_0) exp(-k_2 .* t) .* psi_2_0;
        
        u_1_t_0 = @(t, psi_2_0) (psi_2_t_0(t, psi_2_0) - alpha) ./ 2;
        
        x_2_t_0_first = @(t, psi_2_0) (psi_2_0.*(exp(k_2.*t)./2 - exp(-k_2.*t)./2))./(2.*k_2) - (alpha.*(exp(k_2.*t) - 1))./(2.*k_2);
        
        % without switches
        
        psi_2_0_cur = fsolve(@(psi_2_0) x_2_t_0_first(T, psi_2_0) - (S - epsilon), alpha, fsolve_opts);
        
        if (psi_2_0_cur >= alpha)
            u_1_t = @(t) u_1_t_0(t, psi_2_0_cur);
            
            if (u_1_t(T) > 0)

                int_func = @(t) u_1_t(t) .^ 2 + alpha .* u_1_t(t);

                functional_cur = integral(int_func, 0, T);

                x_2_t = @(t) x_2_t_0_first(t, psi_2_0_cur);

                x_1_t = @(t) - ((exp(-k_2.*t).*(alpha.*exp(T.*k_2) - alpha.*exp(2.*T.*k_2) + alpha.*exp(k_2.*t) - alpha.*exp(2.*k_2.*t) - 2.*alpha.*exp(T.*k_2).*exp(k_2.*t) + alpha.*exp(T.*k_2).*exp(2.*k_2.*t) + alpha.*exp(2.*T.*k_2).*exp(k_2.*t)))./2 - (k_2.*exp(-k_2.*t).*(2.*S.*exp(T.*k_2) - 2.*epsilon.*exp(T.*k_2) - alpha.*t.*exp(k_2.*t) - 4.*S.*exp(T.*k_2).*exp(k_2.*t) + 2.*S.*exp(T.*k_2).*exp(2.*k_2.*t) + 4.*epsilon.*exp(T.*k_2).*exp(k_2.*t) - 2.*epsilon.*exp(T.*k_2).*exp(2.*k_2.*t) + alpha.*t.*exp(2.*T.*k_2).*exp(k_2.*t)))./2)./(k_2.^2.*(exp(2.*T.*k_2) - 1)) - (k_2.*exp(-k_2.*t).*(2.*t.*exp(k_2.*t) - 2.*t.*exp(2.*T.*k_2).*exp(k_2.*t)))./(2.*(exp(2.*T.*k_2) - 1));

                if (functional_cur < functional_min && ... 
                    abs(L - x_1_t(T)) <= epsilon + delta)

                    psi_2_t = @(t) psi_2_t_0(t, psi_2_0_cur);

                    psi1_opt = psi1_cur .* ones(1, number_of_points_for_splitting);
                    psi2_opt = psi_2_t(t_opt);

                    x1_opt = x_1_t(t_opt);
                    x2_opt = x_2_t(t_opt);

                    u1_opt = u_1_t(t_opt);
                    u2_opt = u2_cur .* ones(1, number_of_points_for_splitting);

                    functional_min = functional_cur;
                end
            end
        end
        
        % one switch
        
        tau_cur = log((exp(-T*k_2)*(2*S*k_2 - 2*epsilon*k_2 + alpha*exp(T*k_2) - 2*(k_2*(S - epsilon)*(S*k_2 - epsilon*k_2 + alpha*exp(T*k_2)))^(1/2)))/alpha)/k_2;
        
        psi_2_0_cur = alpha*exp(k_2*tau_cur);
        
        if (psi_2_0_cur >= alpha && ...
            0 < tau_cur && ...
            tau_cur < T)
            u_1_t = @(t) u_1_t_0(t, psi_2_0_cur);

            int_func = @(t) u_1_t(t) .^ 2 + alpha .* u_1_t(t);

            functional_cur = integral(int_func, 0, tau_cur);

            x_2_t_first = @(t) x_2_t_0_first(t, psi_2_0_cur);
            x_2_t_second = @(t) exp(u2_cur * (t - tau_cur)) .* x_2_t_first(tau_cur);

            x_1_t_first = @(t) integral(@(tau) x_2_t_first(tau) + u2_cur, 0, t, 'ArrayValued', true);
            x_1_t_second = @(t) x_1_t_first(tau_cur) + integral(@(tau) x_2_t_second(tau) + u2_cur, tau_cur, t, 'ArrayValued', true);
            %x_1_t_second = @(t) ((3*alpha)/8 + (alpha*log((4*k_2*exp(k_2*tau1)*(exp(-k_2*(T - tau1))*(S - epsilon) + (alpha*(exp(k_2*tau1) - 1))/(2*k_2)))/(alpha*(exp(2*k_2*tau1) - 1))))/4 + (2*k_2^2*(exp(-k_2*(T - tau1))*(S - epsilon) + (alpha*(exp(k_2*tau1) - 1))/(2*k_2))^2)/(alpha*(exp(k_2*tau1) - exp(-k_2*tau1))^2) - (2*k_2*exp(k_2*tau1)*(exp(-k_2*(T - tau1))*(S - epsilon) + (alpha*(exp(k_2*tau1) - 1))/(2*k_2)))/(exp(2*k_2*tau1) - 1))/k_2^2 + k_2*t + (epsilon*exp(-k_2*(T - 2*tau1))*((exp(-k_2*(T - tau1))*(2*S*k_2 - 2*epsilon*k_2 + alpha*exp(T*k_2) - alpha*exp(k_2*(T - tau1))))/(2*alpha*k_2*sinh(k_2*tau1)) - (alpha*exp(k_2*(T + 2*t))*sinh(k_2*tau1))/(2*k_2*(alpha*exp(k_2*(T + tau1)) - alpha*exp(T*k_2) + 2*S*k_2*exp(k_2*tau1) - 2*epsilon*k_2*exp(k_2*tau1)))))/(exp(2*k_2*tau1) - 1) - (alpha*(2*alpha*exp(k_2*(T + tau1)) - 2*alpha*exp(T*k_2) - alpha*exp(k_2*(T + t + tau1)) + alpha*exp(k_2*(T + t - tau1)) + 4*S*k_2*exp(k_2*tau1) - 4*epsilon*k_2*exp(k_2*tau1)))/(4*k_2^2*(alpha*exp(k_2*(T + tau1)) - alpha*exp(T*k_2) + 2*S*k_2*exp(k_2*tau1) - 2*epsilon*k_2*exp(k_2*tau1))) - (S*exp(-k_2*(T - 2*tau1))*((exp(-k_2*(T - tau1))*(2*S*k_2 - 2*epsilon*k_2 + alpha*exp(T*k_2) - alpha*exp(k_2*(T - tau1))))/(2*alpha*k_2*sinh(k_2*tau1)) - (alpha*exp(k_2*(T + 2*t))*sinh(k_2*tau1))/(2*k_2*(alpha*exp(k_2*(T + tau1)) - alpha*exp(T*k_2) + 2*S*k_2*exp(k_2*tau1) - 2*epsilon*k_2*exp(k_2*tau1)))))/(exp(2*k_2*tau1) - 1) + (alpha^2*exp(k_2*tau1)*((exp(-k_2*(T - tau1))*(2*S*k_2 - 2*epsilon*k_2 + alpha*exp(T*k_2) - alpha*exp(k_2*(T - tau1))))/(2*alpha*k_2*sinh(k_2*tau1)) - (alpha*exp(k_2*(T + 2*t))*sinh(k_2*tau1))/(2*k_2*(alpha*exp(k_2*(T + tau1)) - alpha*exp(T*k_2) + 2*S*k_2*exp(k_2*tau1) - 2*epsilon*k_2*exp(k_2*tau1)))))/(16*k_2^2*(exp(-k_2*(T - tau1))*(S - epsilon) + (alpha*(exp(k_2*tau1) - 1))/(2*k_2))) - (alpha^2*exp(-k_2*tau1)*((exp(-k_2*(T - tau1))*(2*S*k_2 - 2*epsilon*k_2 + alpha*exp(T*k_2) - alpha*exp(k_2*(T - tau1))))/(2*alpha*k_2*sinh(k_2*tau1)) - (alpha*exp(k_2*(T + 2*t))*sinh(k_2*tau1))/(2*k_2*(alpha*exp(k_2*(T + tau1)) - alpha*exp(T*k_2) + 2*S*k_2*exp(k_2*tau1) - 2*epsilon*k_2*exp(k_2*tau1)))))/(16*k_2^2*(exp(-k_2*(T - tau1))*(S - epsilon) + (alpha*(exp(k_2*tau1) - 1))/(2*k_2))) + (alpha*exp(k_2*tau1)*((exp(-k_2*(T - tau1))*(2*S*k_2 - 2*epsilon*k_2 + alpha*exp(T*k_2) - alpha*exp(k_2*(T - tau1))))/(2*alpha*k_2*sinh(k_2*tau1)) - (alpha*exp(k_2*(T + 2*t))*sinh(k_2*tau1))/(2*k_2*(alpha*exp(k_2*(T + tau1)) - alpha*exp(T*k_2) + 2*S*k_2*exp(k_2*tau1) - 2*epsilon*k_2*exp(k_2*tau1)))))/(2*k_2*(exp(2*k_2*tau1) - 1)) - (alpha*exp(2*k_2*tau1)*((exp(-k_2*(T - tau1))*(2*S*k_2 - 2*epsilon*k_2 + alpha*exp(T*k_2) - alpha*exp(k_2*(T - tau1))))/(2*alpha*k_2*sinh(k_2*tau1)) - (alpha*exp(k_2*(T + 2*t))*sinh(k_2*tau1))/(2*k_2*(alpha*exp(k_2*(T + tau1)) - alpha*exp(T*k_2) + 2*S*k_2*exp(k_2*tau1) - 2*epsilon*k_2*exp(k_2*tau1)))))/(2*k_2*(exp(2*k_2*tau1) - 1)) - (alpha*exp(k_2*tau1)*(2*alpha*exp(k_2*(T + tau1)) - 2*alpha*exp(T*k_2) - alpha*exp(k_2*(T + t + tau1)) + alpha*exp(k_2*(T + t - tau1)) + 4*S*k_2*exp(k_2*tau1) - 4*epsilon*k_2*exp(k_2*tau1)))/(2*k_2^2*(exp(2*k_2*tau1) - 1)*(alpha*exp(k_2*(T + tau1)) - alpha*exp(T*k_2) + 2*S*k_2*exp(k_2*tau1) - 2*epsilon*k_2*exp(k_2*tau1))) + (alpha*exp(2*k_2*tau1)*(2*alpha*exp(k_2*(T + tau1)) - 2*alpha*exp(T*k_2) - alpha*exp(k_2*(T + t + tau1)) + alpha*exp(k_2*(T + t - tau1)) + 4*S*k_2*exp(k_2*tau1) - 4*epsilon*k_2*exp(k_2*tau1)))/(2*k_2^2*(exp(2*k_2*tau1) - 1)*(alpha*exp(k_2*(T + tau1)) - alpha*exp(T*k_2) + 2*S*k_2*exp(k_2*tau1) - 2*epsilon*k_2*exp(k_2*tau1))) + (S*exp(-k_2*(T - 2*tau1))*(2*alpha*exp(k_2*(T + tau1)) - 2*alpha*exp(T*k_2) - alpha*exp(k_2*(T + t + tau1)) + alpha*exp(k_2*(T + t - tau1)) + 4*S*k_2*exp(k_2*tau1) - 4*epsilon*k_2*exp(k_2*tau1)))/(k_2*(exp(2*k_2*tau1) - 1)*(alpha*exp(k_2*(T + tau1)) - alpha*exp(T*k_2) + 2*S*k_2*exp(k_2*tau1) - 2*epsilon*k_2*exp(k_2*tau1))) - (epsilon*exp(-k_2*(T - 2*tau1))*(2*alpha*exp(k_2*(T + tau1)) - 2*alpha*exp(T*k_2) - alpha*exp(k_2*(T + t + tau1)) + alpha*exp(k_2*(T + t - tau1)) + 4*S*k_2*exp(k_2*tau1) - 4*epsilon*k_2*exp(k_2*tau1)))/(k_2*(exp(2*k_2*tau1) - 1)*(alpha*exp(k_2*(T + tau1)) - alpha*exp(T*k_2) + 2*S*k_2*exp(k_2*tau1) - 2*epsilon*k_2*exp(k_2*tau1)));
            
            if (functional_cur < functional_min && ...
                abs(L - x_1_t_second(T)) <= epsilon + delta)
            
                index = find(t_opt - tau_cur >= 0, 1);
            
                psi_2_t = @(t) psi_2_t_0(t, psi_2_0_cur);
                
                psi1_opt = psi1_cur .* ones(1, number_of_points_for_splitting);
                psi2_opt = psi_2_t(t_opt);
                
                for counter = 1 : number_of_points_for_splitting
                    if counter < index
                        x1_opt(counter) = x_1_t_first(t_opt(counter));
                    else
                        x1_opt(counter) = x_1_t_second(t_opt(counter));
                    end
                end
                
                %x1_opt = [x_1_t_first(t_opt(1 : (index - 1))), x_1_t_second(t_opt(index : end))];
                x2_opt = [x_2_t_first(t_opt(1 : (index - 1))), x_2_t_second(t_opt(index : end))];
                
                u1_opt = [u_1_t(t_opt(1 : (index - 1))), zeros(1, number_of_points_for_splitting - index + 1)];
                u2_opt = u2_cur .* ones(1, number_of_points_for_splitting);
                
                functional_min = functional_cur;
                
                switches = [tau_cur];

            end
        end
        
        tau_cur = log((exp(-T*k_2)*(2*S*k_2 - 2*epsilon*k_2 + alpha*exp(T*k_2) + 2*(k_2*(S - epsilon)*(S*k_2 - epsilon*k_2 + alpha*exp(T*k_2)))^(1/2)))/alpha)/k_2;
        
        psi_2_0_cur = alpha*exp(k_2*tau_cur);
        
        if (psi_2_0_cur >= alpha && ...
            0 < tau_cur && ...
            tau_cur < T)
        
            u_1_t = @(t) u_1_t_0(t, psi_2_0_cur);

            int_func = @(t) u_1_t(t) .^ 2 + alpha .* u_1_t(t);

            functional_cur = integral(int_func, 0, tau_cur);

            x_2_t_first = @(t) x_2_t_0_first(t, psi_2_0_cur);
            x_2_t_second = @(t) exp(u2_cur * (t - tau_cur)) .* x_2_t_first(tau_cur);

            x_1_t_first = @(t) integral(@(tau) x_2_t_first(tau) + u2_cur, 0, t, 'ArrayValued', true);
            x_1_t_second = @(t) x_1_t_first(tau_cur) + integral(@(tau) x_2_t_second(tau) + u2_cur, tau_cur, t, 'ArrayValued', true);
            
            if (functional_cur < functional_min && ...
                abs(L - x_1_t_second(T)) <= epsilon + delta)
            
                index = find(t_opt - tau_cur >= 0, 1);
            
                psi_2_t = @(t) psi_2_t_0(t, psi_2_0_cur);
                
                psi1_opt = psi1_cur .* ones(1, number_of_points_for_splitting);
                psi2_opt = psi_2_t(t_opt);
                
                x1_opt = zeros(1, number_of_points_for_splitting);
                
                for counter = 1 : number_of_points_for_splitting
                    if counter < index
                        x1_opt(counter) = x_1_t_first(t_opt(counter));
                    else
                        x1_opt(counter) = x_1_t_second(t_opt(counter));
                    end
                end
                
                %x1_opt = [x_1_t_first(t_opt(1 : (index - 1))), x_1_t_second(t_opt(index : end))];
                x2_opt = [x_2_t_first(t_opt(1 : (index - 1))), x_2_t_second(t_opt(index : end))];
                
                u1_opt = [u_1_t(t_opt(1 : (index - 1))), zeros(1, number_of_points_for_splitting - index + 1)];
                u2_opt = u2_cur .* ones(1, number_of_points_for_splitting);
                
                functional_min = functional_cur;
                
                switches = [tau_cur];

            end
        end
        
        % psi_1 = 0 is done!

        % we remain in the set S - epsilon >= 0
        
        % second case: psi_1 < 0, psi_2_0 < alpha
         
        u2_first = k_1;
        u2_second = k_1;
        
        psi_2_t_1_0_first = @(t, psi_1, psi_2_0) psi_2_0.*exp(-k_1.*t) + (psi_1.*(exp(-k_1.*t) - 1))./k_1;
        psi_2_t_1_tau1_second = @(t, psi_1, tau1) alpha.*exp(-k_1.*(t - tau1)) + (psi_1.*(exp(-k_1.*(t - tau1)) - 1))./k_1;
        
        u_1_t_1_tau1_second = @(t, psi_1, tau1) (psi_2_t_1_tau1_second(t, psi_1, tau1) - alpha) ./ 2;
        x_2_t_1_tau1_second = @(t, psi_1, tau1) -(exp(-k_1.*(t - tau1)).*(exp(k_1.*(t - tau1)) - 1).^2.*(psi_1 + alpha.*k_1))./(4.*k_1.^2);
        
        x_1_t_1_tau1_second = @(t, psi_1, tau1) -(psi_1.*sinh(k_1.*(t - tau1)) - 2.*k_1.^4.*t + alpha.*k_1.^2.*tau1 + alpha.*k_1.*sinh(k_1.*(t - tau1)) - k_1.*psi_1.*t + k_1.*psi_1.*tau1 - alpha.*k_1.^2.*t)./(2.*k_1.^3);
        
        % one switch
        
        psi_1_cur_tau1 = @(tau1) -(4.*k_1.^2.*exp(k_1.*(T - tau1)).*(S - epsilon + (alpha.*exp(-k_1.*(T - tau1)).*(exp(k_1.*(T - tau1)) - 1).^2)./(4.*k_1)))./(exp(k_1.*(T - tau1)) - 1).^2;
        
        psi_2_0_cur_tau1 = @(tau1) (alpha - 2.*alpha.*exp(k_1.*(T - tau1)) + alpha.*exp(2.*k_1.*(T - tau1)) - 4.*S.*k_1.*exp(T.*k_1) + 4.*epsilon.*k_1.*exp(T.*k_1) + 4.*S.*k_1.*exp(k_1.*(T - tau1)) - 4.*epsilon.*k_1.*exp(k_1.*(T - tau1)))./(exp(k_1.*(T - tau1)) - 1).^2;
        
        tau1_splitting = linspace(0 + trimmer, T - trimmer, number_of_points_for_enum);
        
        for tau1_cur = tau1_splitting
            psi_1_cur = psi_1_cur_tau1(tau1_cur);
            psi_2_0_cur = psi_2_0_cur_tau1(tau1_cur);
            
            x_1_t_second = @(t) x_1_t_1_tau1_second(t, psi_1_cur, tau1_cur);
            
            if (psi_1_cur < 0 && ...
                psi_2_0_cur < alpha && ...
                abs(L + epsilon - x_1_t_second(T)) <= delta)
            
                u_1_t_second = @(t) u_1_t_1_tau1_second(t, psi_1_cur, tau1);
                
                psi_2_t_second =  @(t) psi_2_t_1_tau1_second(t, psi_1_cur, tau1_cur);

                x_2_t_second = @(t) x_2_t_1_tau1_second(t, psi_1_cur, tau1_cur);
                
                if (psi_1_cur + psi_2_t_second(T) * x_2_t_second(T) < 0)
                
                    int_func = @(t) u_1_t_second(t) .^ 2 + alpha .* u_1_t_second(t);

                    functional_cur = integral(int_func, tau1_cur, T);

                    if (functional_cur < functional_min)

                        index = find(t_opt - tau1_cur >= 0, 1);

                        psi_2_t_first = @(t) psi_2_t_1_0_first(t, psi_1_cur, psi_2_0_cur);

                        psi1_opt = psi_1_final .* ones(1, number_of_points_for_splitting);
                        psi2_opt = [psi_2_t_first(t_opt(1 : (index - 1))), psi_2_t_second(t_opt(index : end))];

                        x1_opt = [u2_first .* t_opt(1 : (index - 1)), x_1_t_second(t_opt(index : end))];
                        x2_opt = [zeros(1, index - 1), x_2_t_second(t_opt(index : end))];

                        u1_opt = [zeros(1, index - 1), u_1_t_second(t_opt(index : end))];
                        u2_opt = [u2_first .* ones(1, index - 1), u2_second .* ones(1, number_of_points_for_splitting - index + 1)];

                        functional_min = functional_cur;

                        switches = [tau1_cur];

                    end
                end
            end
        end
        
        % two or more switches
        
        % roots of square equation:
        
        psi_1_cur_tau1_tau2_1 = @(tau1, tau2) (4.*k_1.^3.*exp(k_1.*(tau1 + 2.*tau2)) - 4.*alpha.*k_1.*exp(k_1.*(tau1 + 2.*tau2)) + 5.*alpha.*k_1.*exp(k_1.*(2.*tau1 + tau2)) - 2.*alpha.*k_1.*exp(3.*k_1.*tau1) + alpha.*k_1.*exp(3.*k_1.*tau2) - k_1.*exp(k_1.*tau2).*(6.*alpha.^2.*exp(2.*k_1.*(tau1 + tau2)) + 16.*k_1.^4.*exp(2.*k_1.*(tau1 + tau2)) + alpha.^2.*exp(4.*k_1.*tau1) + alpha.^2.*exp(4.*k_1.*tau2) - 4.*alpha.^2.*exp(k_1.*(tau1 + 3.*tau2)) - 4.*alpha.^2.*exp(k_1.*(3.*tau1 + tau2)) - 32.*alpha.*k_1.^2.*exp(2.*k_1.*(tau1 + tau2)) - 16.*alpha.*k_1.^2.*exp(4.*k_1.*tau1) + 8.*alpha.*k_1.^2.*exp(k_1.*(tau1 + 3.*tau2)) + 40.*alpha.*k_1.^2.*exp(k_1.*(3.*tau1 + tau2))).^(1./2))./(2.*(exp(3.*k_1.*tau1) - exp(3.*k_1.*tau2) + 3.*exp(k_1.*(tau1 + 2.*tau2)) - 3.*exp(k_1.*(2.*tau1 + tau2))));
        psi_1_cur_tau1_tau2_2 = @(tau1, tau2) (4.*k_1.^3.*exp(k_1.*(tau1 + 2.*tau2)) - 4.*alpha.*k_1.*exp(k_1.*(tau1 + 2.*tau2)) + 5.*alpha.*k_1.*exp(k_1.*(2.*tau1 + tau2)) - 2.*alpha.*k_1.*exp(3.*k_1.*tau1) + alpha.*k_1.*exp(3.*k_1.*tau2) + k_1.*exp(k_1.*tau2).*(6.*alpha.^2.*exp(2.*k_1.*(tau1 + tau2)) + 16.*k_1.^4.*exp(2.*k_1.*(tau1 + tau2)) + alpha.^2.*exp(4.*k_1.*tau1) + alpha.^2.*exp(4.*k_1.*tau2) - 4.*alpha.^2.*exp(k_1.*(tau1 + 3.*tau2)) - 4.*alpha.^2.*exp(k_1.*(3.*tau1 + tau2)) - 32.*alpha.*k_1.^2.*exp(2.*k_1.*(tau1 + tau2)) - 16.*alpha.*k_1.^2.*exp(4.*k_1.*tau1) + 8.*alpha.*k_1.^2.*exp(k_1.*(tau1 + 3.*tau2)) + 40.*alpha.*k_1.^2.*exp(k_1.*(3.*tau1 + tau2))).^(1./2))./(2.*(exp(3.*k_1.*tau1) - exp(3.*k_1.*tau2) + 3.*exp(k_1.*(tau1 + 2.*tau2)) - 3.*exp(k_1.*(2.*tau1 + tau2))));

        psi_2_0_cur_tau1_tau2_1 = @(tau1, tau2) -(4.*k_1.^2.*exp(k_1.*(tau1 + 2.*tau2)) - 2.*alpha.*exp(2.*k_1.*(tau1 + tau2)) + exp(k_1.*(tau1 + tau2)).*(6.*alpha.^2.*exp(2.*k_1.*(tau1 + tau2)) + 16.*k_1.^4.*exp(2.*k_1.*(tau1 + tau2)) + alpha.^2.*exp(4.*k_1.*tau1) + alpha.^2.*exp(4.*k_1.*tau2) - 4.*alpha.^2.*exp(k_1.*(tau1 + 3.*tau2)) - 4.*alpha.^2.*exp(k_1.*(3.*tau1 + tau2)) - 32.*alpha.*k_1.^2.*exp(2.*k_1.*(tau1 + tau2)) - 16.*alpha.*k_1.^2.*exp(4.*k_1.*tau1) + 8.*alpha.*k_1.^2.*exp(k_1.*(tau1 + 3.*tau2)) + 40.*alpha.*k_1.^2.*exp(k_1.*(3.*tau1 + tau2))).^(1./2) - 2.*alpha.*exp(3.*k_1.*tau1) + alpha.*exp(3.*k_1.*tau2) - exp(k_1.*tau2).*(6.*alpha.^2.*exp(2.*k_1.*(tau1 + tau2)) + 16.*k_1.^4.*exp(2.*k_1.*(tau1 + tau2)) + alpha.^2.*exp(4.*k_1.*tau1) + alpha.^2.*exp(4.*k_1.*tau2) - 4.*alpha.^2.*exp(k_1.*(tau1 + 3.*tau2)) - 4.*alpha.^2.*exp(k_1.*(3.*tau1 + tau2)) - 32.*alpha.*k_1.^2.*exp(2.*k_1.*(tau1 + tau2)) - 16.*alpha.*k_1.^2.*exp(4.*k_1.*tau1) + 8.*alpha.*k_1.^2.*exp(k_1.*(tau1 + 3.*tau2)) + 40.*alpha.*k_1.^2.*exp(k_1.*(3.*tau1 + tau2))).^(1./2) - 4.*alpha.*exp(k_1.*(tau1 + 2.*tau2)) + 5.*alpha.*exp(k_1.*(2.*tau1 + tau2)) + alpha.*exp(k_1.*(tau1 + 3.*tau2)) + alpha.*exp(k_1.*(3.*tau1 + tau2)) - 4.*k_1.^2.*exp(2.*k_1.*(tau1 + tau2)))./(2.*(exp(3.*k_1.*tau1) - exp(3.*k_1.*tau2) + 3.*exp(k_1.*(tau1 + 2.*tau2)) - 3.*exp(k_1.*(2.*tau1 + tau2))));
        psi_2_0_cur_tau1_tau2_2 = @(tau1, tau2) -(4.*k_1.^2.*exp(k_1.*(tau1 + 2.*tau2)) - 2.*alpha.*exp(2.*k_1.*(tau1 + tau2)) - exp(k_1.*(tau1 + tau2)).*(6.*alpha.^2.*exp(2.*k_1.*(tau1 + tau2)) + 16.*k_1.^4.*exp(2.*k_1.*(tau1 + tau2)) + alpha.^2.*exp(4.*k_1.*tau1) + alpha.^2.*exp(4.*k_1.*tau2) - 4.*alpha.^2.*exp(k_1.*(tau1 + 3.*tau2)) - 4.*alpha.^2.*exp(k_1.*(3.*tau1 + tau2)) - 32.*alpha.*k_1.^2.*exp(2.*k_1.*(tau1 + tau2)) - 16.*alpha.*k_1.^2.*exp(4.*k_1.*tau1) + 8.*alpha.*k_1.^2.*exp(k_1.*(tau1 + 3.*tau2)) + 40.*alpha.*k_1.^2.*exp(k_1.*(3.*tau1 + tau2))).^(1./2) - 2.*alpha.*exp(3.*k_1.*tau1) + alpha.*exp(3.*k_1.*tau2) + exp(k_1.*tau2).*(6.*alpha.^2.*exp(2.*k_1.*(tau1 + tau2)) + 16.*k_1.^4.*exp(2.*k_1.*(tau1 + tau2)) + alpha.^2.*exp(4.*k_1.*tau1) + alpha.^2.*exp(4.*k_1.*tau2) - 4.*alpha.^2.*exp(k_1.*(tau1 + 3.*tau2)) - 4.*alpha.^2.*exp(k_1.*(3.*tau1 + tau2)) - 32.*alpha.*k_1.^2.*exp(2.*k_1.*(tau1 + tau2)) - 16.*alpha.*k_1.^2.*exp(4.*k_1.*tau1) + 8.*alpha.*k_1.^2.*exp(k_1.*(tau1 + 3.*tau2)) + 40.*alpha.*k_1.^2.*exp(k_1.*(3.*tau1 + tau2))).^(1./2) - 4.*alpha.*exp(k_1.*(tau1 + 2.*tau2)) + 5.*alpha.*exp(k_1.*(2.*tau1 + tau2)) + alpha.*exp(k_1.*(tau1 + 3.*tau2)) + alpha.*exp(k_1.*(3.*tau1 + tau2)) - 4.*k_1.^2.*exp(2.*k_1.*(tau1 + tau2)))./(2.*(exp(3.*k_1.*tau1) - exp(3.*k_1.*tau2) + 3.*exp(k_1.*(tau1 + 2.*tau2)) - 3.*exp(k_1.*(2.*tau1 + tau2))));
        
        tau1_splitting = linspace(0 + trimmer, T - trimmer, number_of_points_for_enum);
        
        counter = 0;
        for tau1_cur = tau1_splitting
            counter = counter + 1;
            tau2_splitting = tau1_splitting((counter + 1) : end);
            for tau2_cur = tau2_splitting
                
                psi_1_cur_1 = psi_1_cur_tau1_tau2_1(tau1_cur, tau2_cur);
                psi_1_cur_2 = psi_1_cur_tau1_tau2_2(tau1_cur, tau2_cur);
                
                psi_2_0_cur_1 = psi_2_0_cur_tau1_tau2_1(tau1_cur, tau2_cur);
                psi_2_0_cur_2 = psi_2_0_cur_tau1_tau2_2(tau1_cur, tau2_cur);
                
                if (imag(psi_1_cur_1) == 0)
                    [t_cur, x_cur] = ode45(@(t, x) odefun_first(t, x, k_1, k_2, alpha, psi_1_cur_1), [0, T], [0, 0, psi_2_0_cur_1]);
                    x_1_vect = x_cur(:, 1);
                    x_2_vect = x_cur(:, 2);
                    psi_2_vect = x_cur(:, 3);
                    if (psi_1_cur_1 < 0 && ...
                        psi_2_0_cur_1 < alpha && ...
                        abs(L + epsilon - x_1_vect(end)) <= delta && ...
                        abs(S - epsilon - x_2_vect(end)) <= delta)

                        u_1_vect = (psi_2_vect > alpha) .* (psi_2_vect - alpha) ./ 2;

                        functional_cur = trapz(t_cur, u_1_vect .^ 2 + alpha .* u_1_vect);
                        
                        if (functional_cur < functional_min)
                            
                            u_2_vect = (psi_1_cur_1 + psi_2_vect .* x_2_vect > 0) .* k_2 + ...
                                       (psi_1_cur_1 + psi_2_vect .* x_2_vect < 0) .* k_1;
                                   
                            t_opt = t_cur.';
                            
                            psi1_opt = psi_1_cur_1 .* ones(1, length(t_cur));
                            psi2_opt = psi_2_vect.';
                            
                            x1_opt = x_1_vect.';
                            x2_opt = x_2_vect.';
                            
                            u1_opt = u_1_vect.';
                            u2_opt = u_2_vect.';
                            
                            functional_min = functional_cur;
                            
                            switches = t_opt(u_2_vect(1 : (end - 1)) .* u_2_vect(2 : end) < 0);
                        end
                    end
                end    
                
                if (imag(psi_1_cur_2) == 0)
                    [t_cur, x_cur] = ode45(@(t, x) odefun_first(t, x, k_1, k_2, alpha, psi_1_cur_2), [0, T], [0, 0, psi_2_0_cur_1]);
                    x_1_vect = x_cur(:, 1);
                    x_2_vect = x_cur(:, 2);
                    psi_2_vect = x_cur(:, 3);
                    if (psi_1_cur_2 < 0 && ...
                        psi_2_0_cur_2 < alpha && ...
                        abs(L + epsilon - x_1_vect(end)) <= delta && ...
                        abs(S - epsilon - x_2_vect(end)) <= delta)

                        u_1_vect = (psi_2_vect > alpha) .* (psi_2_vect - alpha) ./ 2;

                        functional_cur = trapz(t_cur, u_1_vect .^ 2 + alpha .* u_1_vect);
                        
                        if (functional_cur < functional_min)
                            
                            u_2_vect = (psi_1_cur_1 + psi_2_vect .* x_2_vect > 0) .* k_2 + ...
                                       (psi_1_cur_1 + psi_2_vect .* x_2_vect < 0) .* k_1;
                                   
                            t_opt = t_cur.';
                            
                            psi1_opt = psi_1_cur_1 .* ones(1, length(t_cur));
                            psi2_opt = psi_2_vect.';
                            
                            x1_opt = x_1_vect.';
                            x2_opt = x_2_vect.';
                            
                            u1_opt = u_1_vect.';
                            u2_opt = u_2_vect.';
                            
                            functional_min = functional_cur;
                            
                            switches = t_opt(u_2_vect(1 : (end - 1)) .* u_2_vect(2 : end) < 0);
                        end
                    end
                end
            end
        end
        
        % third case: psi_1 < 0, psi_2_0 >= alpha
        
        u2_first = k_1;
        psi_2_t_1_0_first = @(t, psi_1, psi_2_0) psi_2_0.*exp(-k_1.*t) + (psi_1.*(exp(-k_1.*t) - 1))./k_1;
        
        u_1_t_1_0_first = @(t, psi_1, psi_2_0) (psi_2_t_1_0_first(t, psi_1, psi_2_0) - alpha) ./ 2;
        x_2_t_1_0_first = @(t, psi_1, psi_2_0) (exp(-k_1.*t).*(exp(k_1.*t) - 1).*(psi_1 + k_1.*psi_2_0 - psi_1.*exp(k_1.*t) - 2.*alpha.*k_1.*exp(k_1.*t) + k_1.*psi_2_0.*exp(k_1.*t)))./(4.*k_1.^2);
        
        x_1_t_1_0_first = @(t, psi_1, psi_2_0) (2.*alpha.*k_1 - 2.*k_1.*psi_2_0 - psi_1.*exp(k_1.*t) + psi_1.*exp(-k_1.*t) + 4.*k_1.^4.*t + 2.*k_1.*psi_1.*t - 2.*alpha.*k_1.*exp(k_1.*t) + k_1.*psi_2_0.*exp(k_1.*t) + k_1.*psi_2_0.*exp(-k_1.*t) + 2.*alpha.*k_1.^2.*t)./(4.*k_1.^3);
        
        % without switches
        
        psi_1_cur = -(k_1*(2*alpha - 2*S*k_1 + 2*epsilon*k_1 - 2*alpha*exp(T*k_1) - 2*L*k_1^2 + 2*T*k_1^3 - 2*epsilon*k_1^2 + 2*T*k_1^3*exp(T*k_1) - 2*epsilon*k_1^2*exp(T*k_1) + T*alpha*k_1 + 2*S*k_1*exp(T*k_1) - 2*epsilon*k_1*exp(T*k_1) - 2*L*k_1^2*exp(T*k_1) + T*alpha*k_1*exp(T*k_1)))/(T*k_1 - 2*exp(T*k_1) + T*k_1*exp(T*k_1) + 2);
        psi_2_0_cur = -(2*alpha - 2*S*k_1 + 2*epsilon*k_1 - 4*alpha*exp(T*k_1) + 2*alpha*exp(2*T*k_1) - 2*L*k_1^2 + 2*T*k_1^3 - 2*epsilon*k_1^2 - 4*T*k_1^3*exp(T*k_1) + 2*T*k_1^3*exp(2*T*k_1) + 4*epsilon*k_1^2*exp(T*k_1) - 2*epsilon*k_1^2*exp(2*T*k_1) + T*alpha*k_1 + 2*S*k_1*exp(2*T*k_1) - 2*epsilon*k_1*exp(2*T*k_1) + 4*L*k_1^2*exp(T*k_1) - 2*L*k_1^2*exp(2*T*k_1) - T*alpha*k_1*exp(2*T*k_1) - 4*S*T*k_1^2*exp(T*k_1) + 4*T*epsilon*k_1^2*exp(T*k_1))/((exp(T*k_1) - 1)*(T*k_1 - 2*exp(T*k_1) + T*k_1*exp(T*k_1) + 2));
        
        if (psi_1_cur < 0 && ...
            psi_2_0_cur >= alpha)
            
            u_1_t_first = @(t) u_1_t_1_0_first(t, psi_1_cur, psi_2_0_cur);
            
            psi_2_t_first = @(t) psi_2_t_1_0_first(t, psi_1_cur, psi_2_0_cur);
            x_2_t_first = @(t) x_2_t_1_0_first(t, psi_1_cur, psi_2_0_cur);
            
            if (psi_1_cur + psi_2_t_first(T) * x_2_t_first(T) < 0)
            
                int_func = @(t) u_1_t_first(t) .^ 2 + alpha .* u_1_t_first(t);

                functional_cur = integral(int_func, 0, T);

                if (functional_cur < functional_min)
                    t_opt = linspace(0, T, number_of_points_for_splitting);

                    x_1_t_first = @(t) x_1_t_1_0_first(t, psi_1_cur, psi_2_0_cur);


                    psi1_opt = psi_1_cur .* ones(1, number_of_points_for_splitting);
                    psi2_opt = psi_2_t_first(t_opt);

                    x1_opt = x_1_t_first(t_opt);
                    x2_opt = x_2_t_first(t_opt);

                    u1_opt = u_1_t_first(t_opt);
                    u2_opt = u2_first .* ones(1, number_of_points_for_splitting);

                    functional_min = functional_cur;
                end
            end
        end
        
        % one switch
        
        u2_second = k_2;
        
        psi_2_t_1_0_tau1_second = @(t, psi_1, psi_2_0, tau1) exp(-k_2.*(t - tau1)).*(psi_2_0.*exp(-k_1.*tau1) + (psi_1.*(exp(-k_1.*tau1) - 1))/k_1) + (psi_1.*(exp(-k_2.*(t - tau1)) - 1))/k_2;
        
        u_1_t_1_0_tau1_second = @(t, psi_1, psi_2_0, tau1) ...
            (psi_2_t_1_0_tau1_second(t, psi_1, psi_2_0, tau1) - alpha) ./ 2;
        
        x_2_t_1_0_tau1_second = @(t, psi_1, psi_2_0, tau1) (psi_1.*exp(- k_2.*t - k_2.*tau1).*(exp(2.*k_2.*t) - exp(2.*k_2.*tau1)))./(4.*k_2.^2) - (psi_1.*(exp(k_2.*(t - tau1)) - 1))./(2.*k_2.^2) - (alpha.*(exp(k_2.*(t - tau1)) - 1))./(2.*k_2) + (psi_2_0.*exp(- k_2.*t - k_2.*tau1).*exp(-k_1.*tau1).*(exp(2.*k_2.*t) - exp(2.*k_2.*tau1)))./(4.*k_2) - (psi_1.*exp(- k_2.*t - k_2.*tau1).*(exp(2.*k_2.*t) - exp(2.*k_2.*tau1)))./(4.*k_1.*k_2) + (exp(-k_1.*tau1).*exp(k_2.*(t - tau1)).*(exp(k_1.*tau1) - 1).*(psi_1 + k_1.*psi_2_0 - psi_1.*exp(k_1.*tau1) - 2.*alpha.*k_1.*exp(k_1.*tau1) + k_1.*psi_2_0.*exp(k_1.*tau1)))./(4.*k_1.^2) + (psi_1.*exp(- k_2.*t - k_2.*tau1).*exp(-k_1.*tau1).*(exp(2.*k_2.*t) - exp(2.*k_2.*tau1)))./(4.*k_1.*k_2);
        x_1_t_1_0_tau1_second = @(t, psi_1, psi_2_0, tau1) k_1.*tau1 + k_2.*(t - tau1) + (alpha.*tau1)./(2.*k_1) + (psi_1.*tau1)./(2.*k_1.^2) + (alpha.*(t - tau1))./(2.*k_2) + (psi_1.*(t - tau1))./(2.*k_2.^2) + (psi_1 - psi_1.*exp(-k_2.*(t - tau1)))./(4.*k_1.*k_2.^2) - (alpha.*(exp(k_1.*tau1) - 1))./(2.*k_1.^2) - (psi_1.*(exp(k_1.*tau1) - 1))./(4.*k_1.^3) + (psi_1.*(exp(-k_1.*tau1) - 1))./(4.*k_1.^3) + (psi_2_0.*(exp(k_1.*tau1) - 1))./(4.*k_1.^2) + (psi_2_0.*(exp(-k_1.*tau1) - 1))./(4.*k_1.^2) - (alpha.*(exp(k_2.*(t - tau1)) - 1))./(2.*k_2.^2) - (psi_1.*(exp(k_2.*(t - tau1)) - 1))./(4.*k_2.^3) + (psi_1.*exp(2.*k_2.*tau1).*(exp(-k_2.*(t + tau1)) - exp(-2.*k_2.*tau1)))./(4.*k_2.^3) + (psi_2_0.*exp(-tau1.*(k_1 - 2.*k_2)).*(exp(-k_2.*(t + tau1)) - exp(-2.*k_2.*tau1)))./(4.*k_2.^2) + (psi_2_0.*exp(-k_1.*tau1).*(exp(k_2.*(t - tau1)) - 1))./(4.*k_2.^2) + (alpha.*(exp(k_2.*(t - tau1)) - 1))./(2.*k_1.*k_2) - (psi_1.*(exp(k_2.*(t - tau1)) - 1))./(4.*k_1.*k_2.^2) + (psi_1.*(exp(k_2.*(t - tau1)) - 1))./(2.*k_1.^2.*k_2) + (psi_1.*exp(-tau1.*(k_1 - 2.*k_2)).*(exp(-k_2.*(t + tau1)) - exp(-2.*k_2.*tau1)))./(4.*k_1.*k_2.^2) - (alpha.*exp(k_1.*tau1).*(exp(k_2.*(t - tau1)) - 1))./(2.*k_1.*k_2) - (psi_1.*exp(k_1.*tau1).*(exp(k_2.*(t - tau1)) - 1))./(4.*k_1.^2.*k_2) + (psi_1.*exp(-k_1.*tau1).*(exp(k_2.*(t - tau1)) - 1))./(4.*k_1.*k_2.^2) - (psi_1.*exp(-k_1.*tau1).*(exp(k_2.*(t - tau1)) - 1))./(4.*k_1.^2.*k_2) + (psi_2_0.*exp(k_1.*tau1).*(exp(k_2.*(t - tau1)) - 1))./(4.*k_1.*k_2) - (psi_2_0.*exp(-k_1.*tau1).*(exp(k_2.*(t - tau1)) - 1))./(4.*k_1.*k_2);
        
        psi_1_cur_tau1 = @(tau1) -(2.*k_1.*k_2.*(4.*S.*k_1.*k_2.^3 - 4.*alpha.*k_2.^3.*exp(k_2.*(T - tau1)) - 4.*alpha.*k_1.^3.*exp(-k_1.*tau1) + 2.*alpha.*k_1.^3.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + 2.*alpha.*k_1.^3.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) + 2.*alpha.*k_2.^3.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) + 2.*alpha.*k_2.^3.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) - 2.*alpha.*k_1.*k_2.^2 - 2.*alpha.*k_1.^2.*k_2 - 4.*epsilon.*k_1.*k_2.^3 - 2.*S.*k_1.^3.*k_2.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) - 2.*S.*k_1.^3.*k_2.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) - alpha.*k_1.*k_2.^2.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) + alpha.*k_1.^2.*k_2.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) - 2.*alpha.*k_1.*k_2.^2.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + alpha.*k_1.*k_2.^2.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) - 2.*alpha.*k_1.^2.*k_2.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) - alpha.*k_1.^2.*k_2.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) + 2.*epsilon.*k_1.^3.*k_2.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + 2.*epsilon.*k_1.^3.*k_2.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) - 2.*S.*k_1.*k_2.^3.*exp(k_1.*tau1) - 2.*S.*k_1.*k_2.^3.*exp(-k_1.*tau1) + 4.*S.*k_1.^3.*k_2.*exp(-k_1.*tau1) + alpha.*k_1.*k_2.^2.*exp(k_1.*tau1) - alpha.*k_1.^2.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.^2.*exp(-k_1.*tau1) + 3.*alpha.*k_1.^2.*k_2.*exp(-k_1.*tau1) + 2.*epsilon.*k_1.*k_2.^3.*exp(k_1.*tau1) + 2.*epsilon.*k_1.*k_2.^3.*exp(-k_1.*tau1) - 4.*epsilon.*k_1.^3.*k_2.*exp(-k_1.*tau1) + 2.*L.*k_1.^2.*k_2.^3.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) - 2.*L.*k_1.^2.*k_2.^3.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + 2.*L.*k_1.^3.*k_2.^2.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) - 2.*L.*k_1.^3.*k_2.^2.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) - 2.*S.*k_1.^2.*k_2.^2.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) + 2.*S.*k_1.^2.*k_2.^2.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) - 2.*T.*k_1.^2.*k_2.^4.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) + 2.*T.*k_1.^2.*k_2.^4.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) - 2.*T.*k_1.^3.*k_2.^3.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + 2.*T.*k_1.^3.*k_2.^3.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) + 3.*alpha.*k_1.*k_2.^2.*exp(k_2.*(T - tau1)) + alpha.*k_1.^2.*k_2.*exp(k_2.*(T - tau1)) - alpha.*k_1.*k_2.^2.*exp(-k_2.*(T - tau1)) + alpha.*k_1.^2.*k_2.*exp(-k_2.*(T - tau1)) + 2.*epsilon.*k_1.^2.*k_2.^2.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) - 2.*epsilon.*k_1.^2.*k_2.^2.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + 2.*epsilon.*k_1.^2.*k_2.^3.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) - 2.*epsilon.*k_1.^2.*k_2.^3.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + 2.*epsilon.*k_1.^3.*k_2.^2.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) - 2.*epsilon.*k_1.^3.*k_2.^2.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) + 2.*k_1.^2.*k_2.^4.*tau1.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) - 2.*k_1.^3.*k_2.^3.*tau1.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) - 2.*k_1.^2.*k_2.^4.*tau1.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + 4.*k_1.^3.*k_2.^3.*tau1.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) - 2.*k_1.^3.*k_2.^3.*tau1.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) - 2.*k_1.^4.*k_2.^2.*tau1.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + 2.*k_1.^4.*k_2.^2.*tau1.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) + 2.*S.*k_1.^2.*k_2.^2.*exp(k_1.*tau1) - 2.*S.*k_1.^2.*k_2.^2.*exp(-k_1.*tau1) - 2.*epsilon.*k_1.^2.*k_2.^2.*exp(k_1.*tau1) + 2.*epsilon.*k_1.^2.*k_2.^2.*exp(-k_1.*tau1) - T.*alpha.*k_1.^2.*k_2.^2.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) + T.*alpha.*k_1.^2.*k_2.^2.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + alpha.*k_1.^2.*k_2.^2.*tau1.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) - 2.*alpha.*k_1.^2.*k_2.^2.*tau1.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + alpha.*k_1.^2.*k_2.^2.*tau1.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) - T.*alpha.*k_1.^3.*k_2.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + T.*alpha.*k_1.^3.*k_2.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) - alpha.*k_1.*k_2.^3.*tau1.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) + alpha.*k_1.*k_2.^3.*tau1.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + alpha.*k_1.^3.*k_2.*tau1.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) - alpha.*k_1.^3.*k_2.*tau1.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2)))./(4.*k_1.^4.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + 4.*k_1.^4.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) + 4.*k_2.^4.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) + 4.*k_2.^4.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) - 8.*k_1.^4.*exp(-k_1.*tau1) - 8.*k_2.^4.*exp(k_2.*(T - tau1)) - 8.*k_1.^2.*k_2.^2 - 4.*k_1.^3.*k_2.*exp(k_1.*tau1) + 4.*k_1.^3.*k_2.*exp(-k_1.*tau1) + 4.*k_1.*k_2.^3.*exp(k_2.*(T - tau1)) - 4.*k_1.*k_2.^3.*exp(-k_2.*(T - tau1)) - 2.*k_1.^2.*k_2.^2.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) - 2.*k_1.^2.*k_2.^2.*exp(k_1.*tau1 - T.*k_2 + k_2.*tau1) - 2.*k_1.^2.*k_2.^2.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) - 2.*k_1.^2.*k_2.^2.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1) + 4.*k_1.^2.*k_2.^2.*exp(-k_1.*tau1) + 4.*k_1.^2.*k_2.^2.*exp(k_2.*(T - tau1)) + 4.*k_1.^2.*k_2.^2.*exp(-k_2.*(T - tau1)) - k_1.*k_2.^3.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) + k_1.*k_2.^3.*exp(k_1.*tau1 - T.*k_2 + k_2.*tau1) + 3.*k_1.^3.*k_2.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) + k_1.^3.*k_2.*exp(k_1.*tau1 - T.*k_2 + k_2.*tau1) - 3.*k_1.*k_2.^3.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + 3.*k_1.*k_2.^3.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) - 3.*k_1.^3.*k_2.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) - k_1.^3.*k_2.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) - 2.*T.*k_1.^4.*k_2.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + 2.*T.*k_1.^4.*k_2.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) - 2.*k_1.*k_2.^4.*tau1.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) + 2.*k_1.*k_2.^4.*tau1.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + 2.*k_1.^4.*k_2.*tau1.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) - 2.*k_1.^4.*k_2.*tau1.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) - 2.*T.*k_1.^3.*k_2.^2.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) + 2.*T.*k_1.^3.*k_2.^2.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + 2.*k_1.^3.*k_2.^2.*tau1.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) - 2.*k_1.^2.*k_2.^3.*tau1.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + 2.*k_1.^2.*k_2.^3.*tau1.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) - 2.*k_1.^3.*k_2.^2.*tau1.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1));
        psi_2_0_cur_tau1 = @(tau1) (2.*(4.*L.*k_1.^4.*k_2.^2 - 4.*alpha.*k_1.^4 + 2.*alpha.*k_1.^4.*exp(k_2.*(T - tau1)) + 2.*alpha.*k_1.^4.*exp(-k_2.*(T - tau1)) - 4.*alpha.*k_2.^4.*exp(k_2.*(T - tau1)) + 4.*S.*k_1.^2.*k_2.^3 - 4.*S.*k_1.^3.*k_2.^2 - 4.*T.*k_1.^4.*k_2.^3 - 8.*alpha.*k_1.^2.*k_2.^2 - 4.*epsilon.*k_1.^2.*k_2.^3 + 4.*epsilon.*k_1.^3.*k_2.^2 + 4.*epsilon.*k_1.^4.*k_2.^2 + 4.*k_1.^4.*k_2.^3.*tau1 - 4.*k_1.^5.*k_2.^2.*tau1 + 2.*alpha.*k_2.^4.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) + 2.*alpha.*k_2.^4.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + 8.*alpha.*k_1.^3.*k_2 - 4.*T.*k_1.^2.*k_2.^5.*exp(k_2.*(T - tau1)) + 2.*T.*k_1.^3.*k_2.^4.*exp(k_2.*(T - tau1)) + 2.*T.*k_1.^4.*k_2.^3.*exp(k_2.*(T - tau1)) - 2.*T.*k_1.^3.*k_2.^4.*exp(-k_2.*(T - tau1)) + 2.*T.*k_1.^4.*k_2.^3.*exp(-k_2.*(T - tau1)) + 5.*alpha.*k_1.^2.*k_2.^2.*exp(k_2.*(T - tau1)) + 3.*alpha.*k_1.^2.*k_2.^2.*exp(-k_2.*(T - tau1)) + 4.*epsilon.*k_1.^2.*k_2.^3.*exp(k_2.*(T - tau1)) - 2.*epsilon.*k_1.^3.*k_2.^2.*exp(k_2.*(T - tau1)) + 4.*epsilon.*k_1.^2.*k_2.^4.*exp(k_2.*(T - tau1)) - 2.*epsilon.*k_1.^3.*k_2.^2.*exp(-k_2.*(T - tau1)) - 2.*epsilon.*k_1.^3.*k_2.^3.*exp(k_2.*(T - tau1)) - 2.*epsilon.*k_1.^4.*k_2.^2.*exp(k_2.*(T - tau1)) + 2.*epsilon.*k_1.^3.*k_2.^3.*exp(-k_2.*(T - tau1)) - 2.*epsilon.*k_1.^4.*k_2.^2.*exp(-k_2.*(T - tau1)) + 4.*k_1.^2.*k_2.^5.*tau1.*exp(k_2.*(T - tau1)) - 6.*k_1.^3.*k_2.^4.*tau1.*exp(k_2.*(T - tau1)) + 2.*k_1.^5.*k_2.^2.*tau1.*exp(k_2.*(T - tau1)) + 2.*k_1.^3.*k_2.^4.*tau1.*exp(-k_2.*(T - tau1)) - 4.*k_1.^4.*k_2.^3.*tau1.*exp(-k_2.*(T - tau1)) + 2.*k_1.^5.*k_2.^2.*tau1.*exp(-k_2.*(T - tau1)) + alpha.*k_1.*k_2.^3.*exp(k_1.*tau1 - T.*k_2 + k_2.*tau1) + 3.*alpha.*k_1.^3.*k_2.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) + alpha.*k_1.^3.*k_2.*exp(k_1.*tau1 - T.*k_2 + k_2.*tau1) - 2.*alpha.*k_1.*k_2.^3.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + alpha.*k_1.*k_2.^3.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) + 2.*alpha.*k_1.^3.*k_2.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + 2.*alpha.*k_1.^3.*k_2.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) + 2.*S.*k_1.*k_2.^4.*exp(k_1.*tau1) - 2.*S.*k_1.*k_2.^4.*exp(-k_1.*tau1) - alpha.*k_1.*k_2.^3.*exp(k_1.*tau1) - 4.*alpha.*k_1.^3.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.^3.*exp(-k_1.*tau1) - 4.*alpha.*k_1.^3.*k_2.*exp(-k_1.*tau1) - 4.*S.*T.*k_1.^4.*k_2.^2 - 2.*epsilon.*k_1.*k_2.^4.*exp(k_1.*tau1) + 2.*epsilon.*k_1.*k_2.^4.*exp(-k_1.*tau1) + 2.*S.*k_1.^4.*k_2.*exp(k_2.*(T - tau1)) - 2.*S.*k_1.^4.*k_2.*exp(-k_2.*(T - tau1)) - 2.*L.*k_1.^2.*k_2.^4.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) - 2.*L.*k_1.^2.*k_2.^4.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + 2.*L.*k_1.^3.*k_2.^3.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) - 2.*L.*k_1.^3.*k_2.^3.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) + 2.*S.*k_1.^2.*k_2.^3.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) + 2.*S.*k_1.^2.*k_2.^3.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) - 2.*S.*k_1.^3.*k_2.^2.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) - 2.*S.*k_1.^3.*k_2.^2.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) + 2.*T.*k_1.^2.*k_2.^5.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) + 2.*T.*k_1.^2.*k_2.^5.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) - 2.*T.*k_1.^3.*k_2.^4.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + 2.*T.*k_1.^3.*k_2.^4.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) + 4.*T.*epsilon.*k_1.^4.*k_2.^2 + 2.*alpha.*k_1.*k_2.^3.*exp(k_2.*(T - tau1)) - 5.*alpha.*k_1.^3.*k_2.*exp(k_2.*(T - tau1)) - 2.*alpha.*k_1.*k_2.^3.*exp(-k_2.*(T - tau1)) - 3.*alpha.*k_1.^3.*k_2.*exp(-k_2.*(T - tau1)) - 2.*epsilon.*k_1.^4.*k_2.*exp(k_2.*(T - tau1)) + 2.*epsilon.*k_1.^4.*k_2.*exp(-k_2.*(T - tau1)) - 3.*alpha.*k_1.^2.*k_2.^2.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) - 2.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1 - T.*k_2 + k_2.*tau1) - 2.*alpha.*k_1.^2.*k_2.^2.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) - alpha.*k_1.^2.*k_2.^2.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) - 4.*S.*k_1.^2.*k_2.^4.*tau1 + 4.*S.*k_1.^4.*k_2.^2.*tau1 - 2.*epsilon.*k_1.^2.*k_2.^3.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) - 2.*epsilon.*k_1.^2.*k_2.^3.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) - 2.*epsilon.*k_1.^2.*k_2.^4.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) + 2.*epsilon.*k_1.^3.*k_2.^2.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + 2.*epsilon.*k_1.^3.*k_2.^2.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) - 2.*epsilon.*k_1.^2.*k_2.^4.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + 2.*epsilon.*k_1.^3.*k_2.^3.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) - 2.*epsilon.*k_1.^3.*k_2.^3.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) + 2.*alpha.*k_1.^2.*k_2.^3.*tau1 - 2.*alpha.*k_1.^3.*k_2.^2.*tau1 - 2.*k_1.^2.*k_2.^5.*tau1.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) + 2.*k_1.^3.*k_2.^4.*tau1.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) - 2.*k_1.^2.*k_2.^5.*tau1.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + 4.*k_1.^3.*k_2.^4.*tau1.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) - 2.*k_1.^3.*k_2.^4.*tau1.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) - 2.*k_1.^4.*k_2.^3.*tau1.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + 2.*k_1.^4.*k_2.^3.*tau1.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) + 4.*epsilon.*k_1.^2.*k_2.^4.*tau1 - 4.*epsilon.*k_1.^4.*k_2.^2.*tau1 - 2.*S.*k_1.^2.*k_2.^3.*exp(k_1.*tau1) - 2.*S.*k_1.^2.*k_2.^3.*exp(-k_1.*tau1) + 4.*S.*k_1.^3.*k_2.^2.*exp(-k_1.*tau1) + 4.*L.*k_1.^2.*k_2.^4.*exp(k_2.*(T - tau1)) - 2.*L.*k_1.^3.*k_2.^3.*exp(k_2.*(T - tau1)) - 2.*L.*k_1.^4.*k_2.^2.*exp(k_2.*(T - tau1)) + 2.*L.*k_1.^3.*k_2.^3.*exp(-k_2.*(T - tau1)) - 2.*L.*k_1.^4.*k_2.^2.*exp(-k_2.*(T - tau1)) + 5.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.*k_1.^2.*k_2.^2.*exp(-k_1.*tau1) + 2.*epsilon.*k_1.^2.*k_2.^3.*exp(k_1.*tau1) + 2.*epsilon.*k_1.^2.*k_2.^3.*exp(-k_1.*tau1) - 4.*epsilon.*k_1.^3.*k_2.^2.*exp(-k_1.*tau1) - 4.*S.*k_1.^2.*k_2.^3.*exp(k_2.*(T - tau1)) + 2.*S.*k_1.^3.*k_2.^2.*exp(k_2.*(T - tau1)) + 2.*S.*k_1.^3.*k_2.^2.*exp(-k_2.*(T - tau1)) - T.*alpha.*k_1.^4.*k_2.*exp(k_2.*(T - tau1)) + T.*alpha.*k_1.^4.*k_2.*exp(-k_2.*(T - tau1)) + T.*alpha.*k_1.^2.*k_2.^3.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) - 2.*T.*alpha.*k_1.^3.*k_2.^2.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) + T.*alpha.*k_1.^2.*k_2.^3.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) - T.*alpha.*k_1.^3.*k_2.^2.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + T.*alpha.*k_1.^3.*k_2.^2.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) + alpha.*k_1.^4.*k_2.*tau1.*exp(k_2.*(T - tau1)) - alpha.*k_1.^4.*k_2.*tau1.*exp(-k_2.*(T - tau1)) - alpha.*k_1.^2.*k_2.^3.*tau1.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) + 2.*alpha.*k_1.^3.*k_2.^2.*tau1.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) - 2.*alpha.*k_1.^2.*k_2.^3.*tau1.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + alpha.*k_1.^2.*k_2.^3.*tau1.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) + alpha.*k_1.^3.*k_2.^2.*tau1.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) - alpha.*k_1.^3.*k_2.^2.*tau1.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) - 2.*T.*alpha.*k_1.^2.*k_2.^3.*exp(k_2.*(T - tau1)) + 3.*T.*alpha.*k_1.^3.*k_2.^2.*exp(k_2.*(T - tau1)) - T.*alpha.*k_1.^3.*k_2.^2.*exp(-k_2.*(T - tau1)) + alpha.*k_1.^2.*k_2.^3.*tau1.*exp(k_2.*(T - tau1)) - 2.*alpha.*k_1.^3.*k_2.^2.*tau1.*exp(k_2.*(T - tau1)) - alpha.*k_1.^2.*k_2.^3.*tau1.*exp(-k_2.*(T - tau1)) + 2.*alpha.*k_1.^3.*k_2.^2.*tau1.*exp(-k_2.*(T - tau1)) - alpha.*k_1.*k_2.^4.*tau1.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) + alpha.*k_1.*k_2.^4.*tau1.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1)))./(4.*k_1.^4.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + 4.*k_1.^4.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) + 4.*k_2.^4.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) + 4.*k_2.^4.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) - 8.*k_1.^4.*exp(-k_1.*tau1) - 8.*k_2.^4.*exp(k_2.*(T - tau1)) - 8.*k_1.^2.*k_2.^2 - 4.*k_1.^3.*k_2.*exp(k_1.*tau1) + 4.*k_1.^3.*k_2.*exp(-k_1.*tau1) + 4.*k_1.*k_2.^3.*exp(k_2.*(T - tau1)) - 4.*k_1.*k_2.^3.*exp(-k_2.*(T - tau1)) - 2.*k_1.^2.*k_2.^2.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) - 2.*k_1.^2.*k_2.^2.*exp(k_1.*tau1 - T.*k_2 + k_2.*tau1) - 2.*k_1.^2.*k_2.^2.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) - 2.*k_1.^2.*k_2.^2.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1) + 4.*k_1.^2.*k_2.^2.*exp(-k_1.*tau1) + 4.*k_1.^2.*k_2.^2.*exp(k_2.*(T - tau1)) + 4.*k_1.^2.*k_2.^2.*exp(-k_2.*(T - tau1)) - k_1.*k_2.^3.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) + k_1.*k_2.^3.*exp(k_1.*tau1 - T.*k_2 + k_2.*tau1) + 3.*k_1.^3.*k_2.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) + k_1.^3.*k_2.*exp(k_1.*tau1 - T.*k_2 + k_2.*tau1) - 3.*k_1.*k_2.^3.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + 3.*k_1.*k_2.^3.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) - 3.*k_1.^3.*k_2.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) - k_1.^3.*k_2.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) - 2.*T.*k_1.^4.*k_2.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + 2.*T.*k_1.^4.*k_2.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) - 2.*k_1.*k_2.^4.*tau1.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) + 2.*k_1.*k_2.^4.*tau1.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + 2.*k_1.^4.*k_2.*tau1.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) - 2.*k_1.^4.*k_2.*tau1.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) - 2.*T.*k_1.^3.*k_2.^2.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) + 2.*T.*k_1.^3.*k_2.^2.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + 2.*k_1.^3.*k_2.^2.*tau1.*exp(T.*k_2 + k_1.*tau1 - k_2.*tau1) - 2.*k_1.^2.*k_2.^3.*tau1.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1) + 2.*k_1.^2.*k_2.^3.*tau1.*exp(k_2.*tau1 - k_1.*tau1 - T.*k_2) - 2.*k_1.^3.*k_2.^2.*tau1.*exp(T.*k_2 - k_1.*tau1 - k_2.*tau1));

        psi_2_t_tau1_second = @(t, tau1) psi_2_t_1_0_tau1_second(t, ...
            psi_1_cur_tau1(tau1), psi_2_0_cur_tau1(tau1), tau1);
        
        x_2_t_tau1_second = @(t, tau1) x_2_t_1_0_tau1_second(t, ...
            psi_1_cur_tau1(tau1), psi_2_0_cur_tau1(tau1), tau1);
        
        tau1_cur = fsolve(@(tau1) ...
            psi_1_cur_tau1(tau1) + psi_2_t_tau1_second(tau1, tau1) .* ...
                x_2_t_tau1_second(tau1, tau1), 0, fsolve_opts);
            
        if (0 < tau1_cur && tau1_cur < T)
            psi_1_cur = psi_1_cur_tau1(tau1_cur);
            psi_2_0_cur = psi_2_0_cur_tau1(tau1_cur);
            
            if (psi_1_cur < 0 && ...
                psi_2_0_cur >= alpha)
            
                u_1_t_first = @(t) u_1_t_1_0_first(t, psi_1_cur, psi_2_0_cur);
                u_1_t_second = @(t) u_1_t_1_0_tau1_second(t, psi_1_cur, psi_2_0_cur, tau1_cur);
                
                if (u_1_t_second(T) >= 0)

                    int_func = @(t) (t < tau1_cur) .* u_1_t_first(t) + (t >= tau1_cur) .* u_1_t_second(t);

                    functional_cur = integral(int_func, 0, T);

                    if (functional_cur < functional_min)

                        t_opt = linspace(0, T, number_of_points_for_splitting);

                        index = find(t_opt - tau1_cur >= 0, 1);

                        psi_2_t_first =  @(t) psi_2_t_1_0_first(t, psi_1_cur, psi_2_0_cur);
                        psi_2_t_second = @(t) psi_2_t_tau1_second(t, tau1_cur);

                        x_1_t_first = @(t) x_1_t_1_0_first(t, psi_1_cur, psi_2_0_cur);
                        x_1_t_second = @(t) x_1_t_1_0_tau1_second(t, psi_1_cur, psi_2_0_cur, tau1_cur);

                        x_2_t_first = @(t) x_2_t_1_0_first(t, psi_1_cur, psi_2_0_cur);
                        x_2_t_second = @(t) x_2_t_tau1_second(t, tau1_cur);

                        psi1_opt = psi_1_cur .* ones(1, number_of_points_for_splitting);
                        psi2_opt = [psi_2_t_first(t_opt(1 : (index - 1))), psi_2_t_second(t_opt(index : end))];

                        x1_opt = [x_1_t_first(t_opt(1 : (index - 1))), x_1_t_second(t_opt(index : end))];
                        x2_opt = [x_2_t_first(t_opt(1 : (index - 1))), x_2_t_second(t_opt(index : end))];

                        u1_opt = [u_1_t_first(t_opt(1 : (index - 1))), u_1_t_second(t_opt(index : end))];
                        u2_opt = [u2_first .* ones(1, index - 1), u2_second .* ones(1, number_of_points_for_splitting - index + 1)];

                        functional_min = functional_cur;

                        switches = [tau1_cur];
                    end
                end
            end
        end
        
        % two switches
        
        psi_1_cur_tau1_tau2_1 = @(tau1, tau2) (k_1.*k_2.*exp(k_2.*(tau1 - tau2)).*(k_1.^2.*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) - 2.*alpha.*k_1.^2.*exp(k_1.*tau1) + 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) + alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_1.*tau1).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) - 2.*alpha.*k_1.*k_2 - 2.*k_1.^2.*exp(k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) + k_1.^2.*exp(2.*k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) + 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) + 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) - k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) + 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) + k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) - 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2)))./(2.*(k_1.*exp(k_1.*tau1) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)))) - (alpha.*k_1.*k_2.*exp(k_1.*tau1))./(k_1.*exp(k_1.*tau1) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)));
        psi_1_cur_tau1_tau2_2 = @(tau1, tau2) - (alpha.*k_1.*k_2.*exp(k_1.*tau1))./(k_1.*exp(k_1.*tau1) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))) - (k_1.*k_2.*exp(k_2.*(tau1 - tau2)).*(k_1.^2.*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_1.*tau1).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) + 2.*alpha.*k_1.*k_2 - 2.*k_1.^2.*exp(k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) + k_1.^2.*exp(2.*k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) + 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) - k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) + k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2)))./(2.*(k_1.*exp(k_1.*tau1) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))));
        
        psi_2_0_cur_tau1_tau2_1 = @(tau1, tau2) (k_1.^2.*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) - 2.*alpha.*k_1.^2.*exp(k_1.*tau1) + 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) + alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_1.*tau1).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) - 2.*alpha.*k_1.*k_2 - 2.*k_1.^2.*exp(k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) + k_1.^2.*exp(2.*k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) + 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) + 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) - k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) + 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) + k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) - 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2))./(2.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))));
        psi_2_0_cur_tau1_tau2_2 = @(tau1, tau2) -(k_1.^2.*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_1.*tau1).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) + 2.*alpha.*k_1.*k_2 - 2.*k_1.^2.*exp(k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) + k_1.^2.*exp(2.*k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) + 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) - k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) + k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)).*((2.*alpha.*k_1.^2.*exp(k_1.*tau1) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1) - alpha.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2 - 4.*k_1.^2.*k_2.^2.*exp(2.*k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 3.*alpha.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 3.*alpha.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + alpha.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*k_1.^3.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 3.*alpha.*k_1.*k_2.*exp(k_1.*tau1) + alpha.*k_1.*k_2.*exp(3.*k_1.*tau1) - 4.*alpha.*k_1.*k_2.*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) + 4.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + 7.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - alpha.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).^2./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2) + (4.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))).*(alpha.^2.*k_2.^2 - 3.*alpha.^2.*k_2.^2.*exp(k_1.*tau1) + 3.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1) - alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_2.^2.*exp(k_2.*(tau1 - tau2)) + 6.*alpha.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 6.*alpha.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_2.^2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1) - 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1) + 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1) + 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1) - 2.*alpha.^2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.^2.*k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^3.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 2.*alpha.^2.*k_1.*k_2.*exp(3.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - 4.*alpha.*k_1.^2.*k_2.^2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 4.*alpha.*k_1.^2.*k_2.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2))))./(k_1.^2.*(exp(k_1.*tau1) - 1).^2.*(exp(k_2.*(tau1 - tau2)) - 1).^2.*(k_1 + k_1.*exp(k_1.*tau1) - k_1.*exp(k_2.*(tau1 - tau2)) - k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2))).^2)).^(1./2))./(2.*(2.*k_1.^2.*exp(k_2.*(tau1 - tau2)) - k_1.^2.*exp(2.*k_2.*(tau1 - tau2)) - k_1.^2 + k_1.^2.*exp(2.*k_1.*tau1) + k_1.*k_2.*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.^2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + k_1.^2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) - 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(k_2.*(tau1 - tau2)) + 2.*k_1.*k_2.*exp(k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2)) + k_1.*k_2.*exp(2.*k_1.*tau1).*exp(k_2.*(tau1 - tau2)) - k_1.*k_2.*exp(2.*k_1.*tau1).*exp(2.*k_2.*(tau1 - tau2))));
        
        tau1_splitting = linspace(0 + trimmer, T - trimmer, number_of_points_for_enum);
        
        counter = 0;
        for tau1_cur = tau1_splitting
            counter = counter + 1;
            tau2_splitting = tau1_splitting((counter + 1) : end);
            for tau2_cur = tau2_splitting
                
                psi_1_cur_1 = psi_1_cur_tau1_tau2_1(tau1_cur, tau2_cur);
                psi_1_cur_2 = psi_1_cur_tau1_tau2_2(tau1_cur, tau2_cur);
                
                psi_2_0_cur_1 = psi_2_0_cur_tau1_tau2_1(tau1_cur, tau2_cur);
                psi_2_0_cur_2 = psi_2_0_cur_tau1_tau2_2(tau1_cur, tau2_cur);
                
                if (imag(psi_1_cur_1) == 0)
                    [t_cur, x_cur] = ode45(@(t, x) odefun_first(t, x, k_1, k_2, alpha, psi_1_cur_1), [0, T], [0, 0, psi_2_0_cur_1]);
                    x_1_vect = x_cur(:, 1);
                    x_2_vect = x_cur(:, 2);
                    psi_2_vect = x_cur(:, 3);
                    if (psi_1_cur_1 < 0 && ...
                        psi_2_0_cur_1 >= alpha && ...
                        abs(L + epsilon - x_1_vect(end)) <= delta && ...
                        abs(S - epsilon - x_2_vect(end)) <= delta)

                        u_1_vect = (psi_2_vect > alpha) .* (psi_2_vect - alpha) ./ 2;

                        functional_cur = trapz(t_cur_1, u_1_vect .^ 2 + alpha .* u_1_vect);
                        
                        if (functional_cur < functional_min)
                            
                            u_2_vect = (psi_1_cur_1 + psi_2_vect .* x_2_vect > 0) .* k_2 + ...
                                       (psi_1_cur_1 + psi_2_vect .* x_2_vect < 0) .* k_1;
                                   
                            t_opt = t_cur.';
                            
                            psi1_opt = psi_1_cur_1 .* ones(1, length(t_cur));
                            psi2_opt = psi_2_vect.';
                            
                            x1_opt = x_1_vect.';
                            x2_opt = x_2_vect.';
                            
                            u1_opt = u_1_vect.';
                            u2_opt = u_2_vect.';
                            
                            functional_min = functional_cur;
                            
                            switches = t_opt(u_2_vect(1 : (end - 1)) .* u_2_vect(2 : end) < 0);
                        end
                    end
                end    
                
                if (imag(psi_1_cur_2) == 0)
                    [t_cur, x_cur] = ode45(@(t, x) odefun_first(t, x, k_1, k_2, alpha, psi_1_cur_2), [0, T], [0, 0, psi_2_0_cur_1]);
                    x_1_vect = x_cur(:, 1);
                    x_2_vect = x_cur(:, 2);
                    psi_2_vect = x_cur(:, 3);
                    if (psi_1_cur_2 < 0 && ...
                        psi_2_0_cur_2 >= alpha && ...
                        abs(L + epsilon - x_1_vect(end)) <= delta && ...
                        abs(S - epsilon - x_2_vect(end)) <= delta)

                        u_1_vect = (psi_2_vect > alpha) .* (psi_2_vect - alpha) ./ 2;

                        functional_cur = trapz(t_cur_1, u_1_vect .^ 2 + alpha .* u_1_vect);
                        
                        if (functional_cur < functional_min)
                            
                            u_2_vect = (psi_1_cur_1 + psi_2_vect .* x_2_vect > 0) .* k_2 + ...
                                       (psi_1_cur_1 + psi_2_vect .* x_2_vect < 0) .* k_1;
                                   
                            t_opt = t_cur.';
                            
                            psi1_opt = psi_1_cur_1 .* ones(1, length(t_cur));
                            psi2_opt = psi_2_vect.';
                            
                            x1_opt = x_1_vect.';
                            x2_opt = x_2_vect.';
                            
                            u1_opt = u_1_vect.';
                            u2_opt = u_2_vect.';
                            
                            functional_min = functional_cur;
                            
                            switches = t_opt(u_2_vect(1 : (end - 1)) .* u_2_vect(2 : end) < 0);
                        end
                    end
                end
            end
        end
    end
    % psi_1 < 0 is done!
    
    % fourth case (the last!): psi_1 > 0, psi_2_0 >= alpha
    
    u2_first = k_2;
    
    psi_2_t_1_0_first = @(t, psi_1, psi_2_0) psi_2_0.*exp(-k_2.*t) + (psi_1.*(exp(-k_2.*t) - 1))./k_2;

    u_1_t_1_0_first = @(t, psi_1, psi_2_0) (psi_2_t_1_0_first(t, psi_1, psi_2_0) - alpha) ./ 2;
    x_2_t_1_0_first = @(t, psi_1, psi_2_0) (exp(-k_2.*t).*(exp(k_2.*t) - 1).*(psi_1 + k_2.*psi_2_0 - psi_1.*exp(k_2.*t) - 2.*alpha.*k_2.*exp(k_2.*t) + k_2.*psi_2_0.*exp(k_2.*t)))./(4.*k_2.^2);

    x_1_t_1_0_first = @(t, psi_1, psi_2_0) (2.*alpha.*k_2 - 2.*k_2.*psi_2_0 - psi_1.*exp(k_2.*t) + psi_1.*exp(-k_2.*t) + 4.*k_2.^4.*t + 2.*k_2.*psi_1.*t - 2.*alpha.*k_2.*exp(k_2.*t) + k_2.*psi_2_0.*exp(k_2.*t) + k_2.*psi_2_0.*exp(-k_2.*t) + 2.*alpha.*k_2.^2.*t)./(4.*k_2.^3);
    
    % without switches
    
    psi_1_cur = -(k_2*(2*alpha - 2*S*k_2 + 2*epsilon*k_2 - 2*alpha*exp(T*k_2) - 2*L*k_2^2 + 2*T*k_2^3 - 2*epsilon*k_2^2 + 2*T*k_2^3*exp(T*k_2) - 2*epsilon*k_2^2*exp(T*k_2) + T*alpha*k_2 + 2*S*k_2*exp(T*k_2) - 2*epsilon*k_2*exp(T*k_2) - 2*L*k_2^2*exp(T*k_2) + T*alpha*k_2*exp(T*k_2)))/(T*k_2 - 2*exp(T*k_2) + T*k_2*exp(T*k_2) + 2);
    psi_2_0_cur = -(2*alpha - 2*S*k_2 + 2*epsilon*k_2 - 4*alpha*exp(T*k_2) + 2*alpha*exp(2*T*k_2) - 2*L*k_2^2 + 2*T*k_2^3 - 2*epsilon*k_2^2 - 4*T*k_2^3*exp(T*k_2) + 2*T*k_2^3*exp(2*T*k_2) + 4*epsilon*k_2^2*exp(T*k_2) - 2*epsilon*k_2^2*exp(2*T*k_2) + T*alpha*k_2 + 2*S*k_2*exp(2*T*k_2) - 2*epsilon*k_2*exp(2*T*k_2) + 4*L*k_2^2*exp(T*k_2) - 2*L*k_2^2*exp(2*T*k_2) - T*alpha*k_2*exp(2*T*k_2) - 4*S*T*k_2^2*exp(T*k_2) + 4*T*epsilon*k_2^2*exp(T*k_2))/((exp(T*k_2) - 1)*(T*k_2 - 2*exp(T*k_2) + T*k_2*exp(T*k_2) + 2));

    if (psi_1_cur < 0 && ...
        psi_2_0_cur >= alpha)

        u_1_t_first = @(t) u_1_t_1_0_first(t, psi_1_cur, psi_2_0_cur);
        
        if (u_1_t_first(T) >= 0)

            int_func = @(t) u_1_t_first(t) .^ 2 + alpha .* u_1_t_first(t);

            functional_cur = integral(int_func, 0, T);

            if (functional_cur < functional_min)
                t_opt = linspace(0, T, number_of_points_for_splitting);

                psi_2_t_first = @(t) psi_2_t_1_0_first(t, psi_1_cur, psi_2_0_cur);

                x_1_t_first = @(t) x_1_t_1_0_first(t, psi_1_cur, psi_2_0_cur);
                x_2_t_first = @(t) x_2_t_1_0_first(t, psi_1_cur, psi_2_0_cur);

                psi1_opt = psi_1_cur .* ones(1, number_of_points_for_splitting);
                psi2_opt = psi_2_t_first(t_opt);

                x1_opt = x_1_t_first(t_opt);
                x2_opt = x_2_t_first(t_opt);

                u1_opt = u_1_t_first(t_opt);
                u2_opt = u2_first .* ones(1, number_of_points_for_splitting);

                functional_min = functional_cur;
            end
        end
    end
    
    % one switch
    
    psi_2_t_1_0_tau1_second = @(t, psi_1, psi_2_0, tau1) alpha.*exp(-k_2.*(t - tau1)) + (psi_1.*(exp(-k_2.*(t - tau1)) - 1))./k_2;
    
    x_2_t_1_0_tau1_second = @(t, psi_1, psi_2_0, tau1) (exp(k_2.*(t - 2.*tau1)).*(exp(k_2.*tau1) - 1).*(psi_1 + k_2.*psi_2_0 - psi_1.*exp(k_2.*tau1) - 2.*alpha.*k_2.*exp(k_2.*tau1) + k_2.*psi_2_0.*exp(k_2.*tau1)))./(4.*k_2.^2);
    
    x_1_t_1_0_tau1_second = @(t, psi_1, psi_2_0, tau1) (2.*psi_1.*exp(-k_2.*tau1) - 2.*k_2.*psi_2_0 - psi_1.*exp(k_2.*t) - 2.*psi_1 + 4.*k_2.^4.*t + 2.*psi_1.*exp(k_2.*(t - tau1)) - psi_1.*exp(k_2.*(t - 2.*tau1)) + 2.*alpha.*k_2.^2.*tau1 + 2.*alpha.*k_2.*exp(k_2.*(t - tau1)) - k_2.*psi_2_0.*exp(k_2.*(t - 2.*tau1)) + 2.*k_2.*psi_1.*tau1 - 2.*alpha.*k_2.*exp(k_2.*t) + k_2.*psi_2_0.*exp(k_2.*t) + 2.*k_2.*psi_2_0.*exp(-k_2.*tau1))./(4.*k_2.^3);
    
    % psi_2_0(T) > 0
    
    psi_1_cur_tau1 = @(tau1) -(2.*S.*k_2.^2.*exp(T.*k_2) + 2.*T.*k_2.^4.*exp(T.*k_2) - 2.*epsilon.*k_2.^2.*exp(T.*k_2) + 2.*epsilon.*k_2.^3.*exp(T.*k_2) - 4.*S.*k_2.^2.*exp(k_2.*tau1) + 4.*epsilon.*k_2.^2.*exp(k_2.*tau1) - 2.*alpha.*k_2.*exp(k_2.*(T + tau1)) + 2.*alpha.*k_2.*exp(T.*k_2) - 2.*L.*k_2.^3.*exp(k_2.*(T + tau1)) + 2.*S.*k_2.^2.*exp(k_2.*(T + tau1)) + 2.*T.*k_2.^4.*exp(k_2.*(T + tau1)) - 2.*epsilon.*k_2.^2.*exp(k_2.*(T + tau1)) + 2.*epsilon.*k_2.^3.*exp(k_2.*(T + tau1)) - 2.*L.*k_2.^3.*exp(T.*k_2) + alpha.*k_2.^2.*tau1.*exp(k_2.*(T + tau1)) + alpha.*k_2.^2.*tau1.*exp(T.*k_2))./(2.*exp(T.*k_2) - 2.*exp(k_2.*(T + tau1)) + k_2.*tau1.*exp(k_2.*(T + tau1)) + k_2.*tau1.*exp(T.*k_2));
    psi_2_0_cur_tau1 = @(tau1) (2.*alpha.*exp(T.*k_2) - 4.*alpha.*exp(k_2.*(T + tau1)) + 2.*alpha.*exp(k_2.*(T + 2.*tau1)) + 2.*T.*k_2.^3.*exp(T.*k_2) + 2.*epsilon.*k_2.^2.*exp(T.*k_2) - 2.*L.*k_2.^2.*exp(k_2.*(T + 2.*tau1)) + 2.*T.*k_2.^3.*exp(k_2.*(T + 2.*tau1)) + 2.*epsilon.*k_2.^2.*exp(k_2.*(T + 2.*tau1)) - 4.*S.*k_2.*exp(k_2.*(T + tau1)) + 4.*epsilon.*k_2.*exp(k_2.*(T + tau1)) + 2.*S.*k_2.*exp(T.*k_2) - 2.*epsilon.*k_2.*exp(T.*k_2) - 4.*S.*k_2.*exp(k_2.*tau1) + 4.*S.*k_2.*exp(2.*k_2.*tau1) + 4.*L.*k_2.^2.*exp(k_2.*(T + tau1)) + 4.*epsilon.*k_2.*exp(k_2.*tau1) - 4.*epsilon.*k_2.*exp(2.*k_2.*tau1) + 2.*S.*k_2.*exp(k_2.*(T + 2.*tau1)) - 4.*T.*k_2.^3.*exp(k_2.*(T + tau1)) - 2.*epsilon.*k_2.*exp(k_2.*(T + 2.*tau1)) - 4.*epsilon.*k_2.^2.*exp(k_2.*(T + tau1)) - 2.*L.*k_2.^2.*exp(T.*k_2) + alpha.*k_2.*tau1.*exp(T.*k_2) - alpha.*k_2.*tau1.*exp(k_2.*(T + 2.*tau1)) - 4.*S.*k_2.^2.*tau1.*exp(2.*k_2.*tau1) + 4.*epsilon.*k_2.^2.*tau1.*exp(2.*k_2.*tau1))./(2.*exp(T.*k_2) - 4.*exp(k_2.*(T + tau1)) + 2.*exp(k_2.*(T + 2.*tau1)) + k_2.*tau1.*exp(T.*k_2) - k_2.*tau1.*exp(k_2.*(T + 2.*tau1)));
    
    psi_2_t_tau1_second = @(t, tau1) psi_2_t_1_0_tau1_second(t, psi_1_cur_tau1(tau1), psi_2_0_cur_tau1(tau1), tau1);
    
    tau1_cur = fsolve(@(tau1) psi_2_t_tau1_second(tau1, tau1) - alpha, T, fsolve_opts);
    
    if (0 < tau1_cur && tau1_cur < T)
        psi_1_cur = psi_1_cur_tau1(tau1_cur);
        psi_2_0_cur = psi_2_0_cur_tau1(tau1_cur);
        
        psi_2_t_second = @(t) psi_2_t_tau1_second(t, tau1_cur);

        if (psi_1_cur > 0 && ...
            psi_2_0_cur >= alpha && ...
            psi_2_t_second(T) > 0)

            u_1_t_first = @(t) u_1_t_1_0_first(t, psi_1_cur, psi_2_0_cur);
            
            psi_2_t_second = @(t) psi_2_t_tau1_second(t, tau1_cur);
            x_2_t_second = @(t) x_2_t_1_0_tau1_second(t, psi_1_cur, psi_2_0_cur, tau1_cur);
            
            if (psi_1_cur + psi_2_t_second(T) * x_2_t_second(T) > 0)

                functional_cur = integral(u_1_t_first, 0, tau1_cur);

                if (functional_cur < functional_min)

                    t_opt = linspace(0, T, number_of_points_for_splitting);

                    index = find(t_opt - tau1_cur >= 0, 1);

                    psi_2_t_first =  @(t) psi_2_t_1_0_first(t, psi_1_cur, psi_2_0_cur);

                    x_1_t_first = @(t) x_1_t_1_0_first(t, psi_1_cur, psi_2_0_cur);
                    x_1_t_second = @(t) x_1_t_1_0_tau1_second(t, psi_1_cur, psi_2_0_cur, tau1_cur);

                    x_2_t_first = @(t) x_2_t_1_0_first(t, psi_1_cur, psi_2_0_cur);

                    psi1_opt = psi_1_final .* ones(1, number_of_points_for_splitting);
                    psi2_opt = [psi_2_t_first(t_opt(1 : (index - 1))), psi_2_t_second(t_opt(index : end))];

                    x1_opt = [x_1_t_first(t_opt(1 : (index - 1))), x_1_t_second(t_opt(index : end))];
                    x2_opt = [x_2_t_first(t_opt(1 : (index - 1))), x_2_t_second(t_opt(index : end))];

                    u1_opt = [u_1_t_first(t_opt(1 : (index - 1))), u_1_t_second(t_opt(index : end))];
                    u2_opt = [u2_first .* ones(1, index - 1), u2_second .* ones(1, number_of_points_for_splitting - index + 1)];

                    functional_min = functional_cur;

                    switches = [tau1_cur];

                end
            end
        end
    end
    
    % psi_2_0(T) < 0
    
    psi_1_cur_tau1 = @(tau1) -(2.*S.*k_2.^2.*exp(T.*k_2) + 2.*T.*k_2.^4.*exp(T.*k_2) + 2.*epsilon.*k_2.^2.*exp(T.*k_2) + 2.*epsilon.*k_2.^3.*exp(T.*k_2) - 4.*S.*k_2.^2.*exp(k_2.*tau1) - 4.*epsilon.*k_2.^2.*exp(k_2.*tau1) - 2.*alpha.*k_2.*exp(k_2.*(T + tau1)) + 2.*alpha.*k_2.*exp(T.*k_2) - 2.*L.*k_2.^3.*exp(k_2.*(T + tau1)) + 2.*S.*k_2.^2.*exp(k_2.*(T + tau1)) + 2.*T.*k_2.^4.*exp(k_2.*(T + tau1)) + 2.*epsilon.*k_2.^2.*exp(k_2.*(T + tau1)) + 2.*epsilon.*k_2.^3.*exp(k_2.*(T + tau1)) - 2.*L.*k_2.^3.*exp(T.*k_2) + alpha.*k_2.^2.*tau1.*exp(k_2.*(T + tau1)) + alpha.*k_2.^2.*tau1.*exp(T.*k_2))./(2.*exp(T.*k_2) - 2.*exp(k_2.*(T + tau1)) + k_2.*tau1.*exp(k_2.*(T + tau1)) + k_2.*tau1.*exp(T.*k_2));
    psi_2_0_cur_tau1 = @(tau1) (2.*alpha.*exp(T.*k_2) - 4.*alpha.*exp(k_2.*(T + tau1)) + 2.*alpha.*exp(k_2.*(T + 2.*tau1)) + 2.*T.*k_2.^3.*exp(T.*k_2) + 2.*epsilon.*k_2.^2.*exp(T.*k_2) - 2.*L.*k_2.^2.*exp(k_2.*(T + 2.*tau1)) + 2.*T.*k_2.^3.*exp(k_2.*(T + 2.*tau1)) + 2.*epsilon.*k_2.^2.*exp(k_2.*(T + 2.*tau1)) - 4.*S.*k_2.*exp(k_2.*(T + tau1)) - 4.*epsilon.*k_2.*exp(k_2.*(T + tau1)) + 2.*S.*k_2.*exp(T.*k_2) + 2.*epsilon.*k_2.*exp(T.*k_2) - 4.*S.*k_2.*exp(k_2.*tau1) + 4.*S.*k_2.*exp(2.*k_2.*tau1) + 4.*L.*k_2.^2.*exp(k_2.*(T + tau1)) - 4.*epsilon.*k_2.*exp(k_2.*tau1) + 4.*epsilon.*k_2.*exp(2.*k_2.*tau1) + 2.*S.*k_2.*exp(k_2.*(T + 2.*tau1)) - 4.*T.*k_2.^3.*exp(k_2.*(T + tau1)) + 2.*epsilon.*k_2.*exp(k_2.*(T + 2.*tau1)) - 4.*epsilon.*k_2.^2.*exp(k_2.*(T + tau1)) - 2.*L.*k_2.^2.*exp(T.*k_2) + alpha.*k_2.*tau1.*exp(T.*k_2) - alpha.*k_2.*tau1.*exp(k_2.*(T + 2.*tau1)) - 4.*S.*k_2.^2.*tau1.*exp(2.*k_2.*tau1) - 4.*epsilon.*k_2.^2.*tau1.*exp(2.*k_2.*tau1))./(2.*exp(T.*k_2) - 4.*exp(k_2.*(T + tau1)) + 2.*exp(k_2.*(T + 2.*tau1)) + k_2.*tau1.*exp(T.*k_2) - k_2.*tau1.*exp(k_2.*(T + 2.*tau1)));
    
    psi_2_t_tau1_second = @(t, tau1) psi_2_t_1_0_tau1_second(t, psi_1_cur_tau1(tau1), psi_2_0_cur_tau1(tau1), tau1);
    
    tau1_cur = fsolve(@(tau1) psi_2_t_tau1_second(tau1, tau1) - alpha, T, fsolve_opts);
    
    if (0 < tau1_cur && tau1_cur < T)
        psi_1_cur = psi_1_cur_tau1(tau1_cur);
        psi_2_0_cur = psi_2_0_cur_tau1(tau1_cur);
        
        psi_2_t_second = @(t) psi_2_t_tau1_second(t, tau1_cur);

        if (psi_1_cur > 0 && ...
            psi_2_0_cur >= alpha && ...
            psi_2_t_second(T) < 0)

            u_1_t_first = @(t) u_1_t_1_0_first(t, psi_1_cur, psi_2_0_cur);
            
            psi_2_t_second = @(t) psi_2_t_tau1_second(t, tau1_cur);
            x_2_t_second = @(t) x_2_t_tau1_second(t, tau1_cur);
            
            if (psi_1_cur + psi_2_t_second(T) * x_2_t_second(T) > 0)

                functional_cur = integral(u_1_t_first, 0, tau1_cur);

                if (functional_cur < functional_min)

                    t_opt = linspace(0, T, number_of_points_for_splitting);

                    index = find(t_opt - tau1_cur >= 0, 1);

                    psi_2_t_first =  @(t) psi_2_t_1_0_first(t, psi_1_cur, psi_2_0_cur);

                    x_1_t_first = @(t) x_1_t_1_0_first(t, psi_1_cur, psi_2_0_cur);
                    x_1_t_second = @(t) x_1_t_1_0_tau1_second(t, psi_1_cur, psi_2_0_cur, tau1_cur);

                    x_2_t_first = @(t) x_2_t_1_0_first(t, psi_1_cur, psi_2_0_cur);

                    psi1_opt = psi_1_final .* ones(1, number_of_points_for_splitting);
                    psi2_opt = [psi_2_t_first(t_opt(1 : (index - 1))), psi_2_t_second(t_opt(index : end))];

                    x1_opt = [x_1_t_first(t_opt(1 : (index - 1))), x_1_t_second(t_opt(index : end))];
                    x2_opt = [x_2_t_first(t_opt(1 : (index - 1))), x_2_t_second(t_opt(index : end))];

                    u1_opt = [u_1_t_first(t_opt(1 : (index - 1))), u_1_t_second(t_opt(index : end))];
                    u2_opt = [u2_first .* ones(1, index - 1), u2_second .* ones(1, number_of_points_for_splitting - index + 1)];

                    functional_min = functional_cur;

                    switches = [tau1_cur];

                end
            end
        end
    end
    
    % two switches
    
    psi_1_cur_tau1_tau2_1 = @(tau1, tau2) -(alpha.*k_2.*exp(k_2.*tau1) - (k_2.*(exp(k_2.*(2.*tau1 - tau2)).*(6.*alpha.^2.*exp(2.*k_2.*(tau1 + tau2)) - 4.*alpha.^2.*exp(k_2.*(3.*tau1 + 2.*tau2)) + alpha.^2.*exp(2.*k_2.*tau2) + 16.*k_2.^4.*exp(2.*k_2.*tau1) - 4.*alpha.^2.*exp(k_2.*(tau1 + 2.*tau2)) + alpha.^2.*exp(2.*k_2.*(2.*tau1 + tau2)) - 8.*alpha.*k_2.^2.*exp(k_2.*(tau1 + tau2)) + 16.*alpha.*k_2.^2.*exp(2.*k_2.*tau1) - 32.*alpha.*k_2.^2.*exp(3.*k_2.*tau1) + 16.*alpha.*k_2.^2.*exp(4.*k_2.*tau1) + 16.*alpha.*k_2.^2.*exp(k_2.*(2.*tau1 + tau2)) - 8.*alpha.*k_2.^2.*exp(k_2.*(3.*tau1 + tau2))).^(1./2) + alpha.*exp(k_2.*(tau1 + tau2)) + 4.*k_2.^2.*exp(k_2.*(3.*tau1 - tau2)) - 3.*alpha.*exp(2.*k_2.*tau1) + 2.*alpha.*exp(3.*k_2.*tau1) + alpha.*exp(4.*k_2.*tau1) - exp(k_2.*tau1).*(6.*alpha.^2.*exp(2.*k_2.*(tau1 + tau2)) - 4.*alpha.^2.*exp(k_2.*(3.*tau1 + 2.*tau2)) + alpha.^2.*exp(2.*k_2.*tau2) + 16.*k_2.^4.*exp(2.*k_2.*tau1) - 4.*alpha.^2.*exp(k_2.*(tau1 + 2.*tau2)) + alpha.^2.*exp(2.*k_2.*(2.*tau1 + tau2)) - 8.*alpha.*k_2.^2.*exp(k_2.*(tau1 + tau2)) + 16.*alpha.*k_2.^2.*exp(2.*k_2.*tau1) - 32.*alpha.*k_2.^2.*exp(3.*k_2.*tau1) + 16.*alpha.*k_2.^2.*exp(4.*k_2.*tau1) + 16.*alpha.*k_2.^2.*exp(k_2.*(2.*tau1 + tau2)) - 8.*alpha.*k_2.^2.*exp(k_2.*(3.*tau1 + tau2))).^(1./2) - alpha.*exp(k_2.*(3.*tau1 + tau2)) - 4.*k_2.^2.*exp(2.*k_2.*tau1) + 2.*alpha.*exp(k_2.*(3.*tau1 - tau2)) - 2.*alpha.*exp(k_2.*(4.*tau1 - tau2))))./(2.*(exp(k_2.*tau1) - exp(k_2.*tau2)).*(exp(k_2.*(2.*tau1 - tau2)) - exp(k_2.*(3.*tau1 - tau2)) - exp(k_2.*tau1) + exp(2.*k_2.*tau1))))./(exp(k_2.*tau1) - 1);
    psi_1_cur_tau1_tau2_2 = @(tau1, tau2) -(alpha.*k_2.*exp(k_2.*tau1) - (k_2.*(alpha.*exp(k_2.*(tau1 + tau2)) - exp(k_2.*(2.*tau1 - tau2)).*(6.*alpha.^2.*exp(2.*k_2.*(tau1 + tau2)) - 4.*alpha.^2.*exp(k_2.*(3.*tau1 + 2.*tau2)) + alpha.^2.*exp(2.*k_2.*tau2) + 16.*k_2.^4.*exp(2.*k_2.*tau1) - 4.*alpha.^2.*exp(k_2.*(tau1 + 2.*tau2)) + alpha.^2.*exp(2.*k_2.*(2.*tau1 + tau2)) - 8.*alpha.*k_2.^2.*exp(k_2.*(tau1 + tau2)) + 16.*alpha.*k_2.^2.*exp(2.*k_2.*tau1) - 32.*alpha.*k_2.^2.*exp(3.*k_2.*tau1) + 16.*alpha.*k_2.^2.*exp(4.*k_2.*tau1) + 16.*alpha.*k_2.^2.*exp(k_2.*(2.*tau1 + tau2)) - 8.*alpha.*k_2.^2.*exp(k_2.*(3.*tau1 + tau2))).^(1./2) + 4.*k_2.^2.*exp(k_2.*(3.*tau1 - tau2)) - 3.*alpha.*exp(2.*k_2.*tau1) + 2.*alpha.*exp(3.*k_2.*tau1) + alpha.*exp(4.*k_2.*tau1) + exp(k_2.*tau1).*(6.*alpha.^2.*exp(2.*k_2.*(tau1 + tau2)) - 4.*alpha.^2.*exp(k_2.*(3.*tau1 + 2.*tau2)) + alpha.^2.*exp(2.*k_2.*tau2) + 16.*k_2.^4.*exp(2.*k_2.*tau1) - 4.*alpha.^2.*exp(k_2.*(tau1 + 2.*tau2)) + alpha.^2.*exp(2.*k_2.*(2.*tau1 + tau2)) - 8.*alpha.*k_2.^2.*exp(k_2.*(tau1 + tau2)) + 16.*alpha.*k_2.^2.*exp(2.*k_2.*tau1) - 32.*alpha.*k_2.^2.*exp(3.*k_2.*tau1) + 16.*alpha.*k_2.^2.*exp(4.*k_2.*tau1) + 16.*alpha.*k_2.^2.*exp(k_2.*(2.*tau1 + tau2)) - 8.*alpha.*k_2.^2.*exp(k_2.*(3.*tau1 + tau2))).^(1./2) - alpha.*exp(k_2.*(3.*tau1 + tau2)) - 4.*k_2.^2.*exp(2.*k_2.*tau1) + 2.*alpha.*exp(k_2.*(3.*tau1 - tau2)) - 2.*alpha.*exp(k_2.*(4.*tau1 - tau2))))./(2.*(exp(k_2.*tau1) - exp(k_2.*tau2)).*(exp(k_2.*(2.*tau1 - tau2)) - exp(k_2.*(3.*tau1 - tau2)) - exp(k_2.*tau1) + exp(2.*k_2.*tau1))))./(exp(k_2.*tau1) - 1);

    psi_2_0_cur_tau1_tau2_1 = @(tau1, tau2) (2.*alpha.*exp(k_2.*tau1) - alpha.*exp(k_2.*tau2) - 2.*alpha.*exp(2.*k_2.*tau1) + (6.*alpha.^2.*exp(2.*k_2.*(tau1 + tau2)) - 4.*alpha.^2.*exp(k_2.*(3.*tau1 + 2.*tau2)) + alpha.^2.*exp(2.*k_2.*tau2) + 16.*k_2.^4.*exp(2.*k_2.*tau1) - 4.*alpha.^2.*exp(k_2.*(tau1 + 2.*tau2)) + alpha.^2.*exp(2.*k_2.*(2.*tau1 + tau2)) - 8.*alpha.*k_2.^2.*exp(k_2.*(tau1 + tau2)) + 16.*alpha.*k_2.^2.*exp(2.*k_2.*tau1) - 32.*alpha.*k_2.^2.*exp(3.*k_2.*tau1) + 16.*alpha.*k_2.^2.*exp(4.*k_2.*tau1) + 16.*alpha.*k_2.^2.*exp(k_2.*(2.*tau1 + tau2)) - 8.*alpha.*k_2.^2.*exp(k_2.*(3.*tau1 + tau2))).^(1./2) + alpha.*exp(k_2.*(2.*tau1 + tau2)) + 4.*k_2.^2.*exp(k_2.*tau1))./(2.*(exp(k_2.*(tau1 + tau2)) + exp(k_2.*tau1) - exp(k_2.*tau2) - exp(2.*k_2.*tau1)));
    psi_2_0_cur_tau1_tau2_2 = @(tau1, tau2) (2.*alpha.*exp(k_2.*tau1) - alpha.*exp(k_2.*tau2) - 2.*alpha.*exp(2.*k_2.*tau1) - (6.*alpha.^2.*exp(2.*k_2.*(tau1 + tau2)) - 4.*alpha.^2.*exp(k_2.*(3.*tau1 + 2.*tau2)) + alpha.^2.*exp(2.*k_2.*tau2) + 16.*k_2.^4.*exp(2.*k_2.*tau1) - 4.*alpha.^2.*exp(k_2.*(tau1 + 2.*tau2)) + alpha.^2.*exp(2.*k_2.*(2.*tau1 + tau2)) - 8.*alpha.*k_2.^2.*exp(k_2.*(tau1 + tau2)) + 16.*alpha.*k_2.^2.*exp(2.*k_2.*tau1) - 32.*alpha.*k_2.^2.*exp(3.*k_2.*tau1) + 16.*alpha.*k_2.^2.*exp(4.*k_2.*tau1) + 16.*alpha.*k_2.^2.*exp(k_2.*(2.*tau1 + tau2)) - 8.*alpha.*k_2.^2.*exp(k_2.*(3.*tau1 + tau2))).^(1./2) + alpha.*exp(k_2.*(2.*tau1 + tau2)) + 4.*k_2.^2.*exp(k_2.*tau1))./(2.*(exp(k_2.*(tau1 + tau2)) + exp(k_2.*tau1) - exp(k_2.*tau2) - exp(2.*k_2.*tau1)));

    tau1_splitting = linspace(0 + trimmer, T - trimmer, number_of_points_for_enum);
        
    counter = 0;
    for tau1_cur = tau1_splitting
        counter = counter + 1;
        tau2_splitting = tau1_splitting((counter + 1) : end);
        for tau2_cur = tau2_splitting

            psi_1_cur_1 = psi_1_cur_tau1_tau2_1(tau1_cur, tau2_cur);
            psi_1_cur_2 = psi_1_cur_tau1_tau2_2(tau1_cur, tau2_cur);

            psi_2_0_cur_1 = psi_2_0_cur_tau1_tau2_1(tau1_cur, tau2_cur);
            psi_2_0_cur_2 = psi_2_0_cur_tau1_tau2_2(tau1_cur, tau2_cur);

            if (imag(psi_1_cur_1) == 0)
                [t_cur, x_cur] = ode45(@(t, x) odefun_first(t, x, k_1, k_2, alpha, psi_1_cur_1), [0, T], [0, 0, psi_2_0_cur_1]);
                x_1_vect = x_cur(:, 1);
                x_2_vect = x_cur(:, 2);
                psi_2_vect = x_cur(:, 3);
                if (psi_1_cur_1 > 0 && ...
                    psi_2_0_cur_1 >= alpha && ...
                    abs(L - epsilon - x_1_vect(end)) <= delta && ...
                    abs(S + epsilon - x_2_vect(end)) <= delta)

                    u_1_vect = (psi_2_vect > alpha) .* (psi_2_vect - alpha) ./ 2;

                    functional_cur = trapz(t_cur, u_1_vect .^ 2 + alpha .* u_1_vect);

                    if (functional_cur < functional_min)

                        u_2_vect = (psi_1_cur_1 + psi_2_vect .* x_2_vect > 0) .* k_2 + ...
                                   (psi_1_cur_1 + psi_2_vect .* x_2_vect < 0) .* k_1;

                        t_opt = t_cur.';

                        psi1_opt = psi_1_cur_1 .* ones(1, length(t_cur));
                        psi2_opt = psi_2_vect.';

                        x1_opt = x_1_vect.';
                        x2_opt = x_2_vect.';

                        u1_opt = u_1_vect.';
                        u2_opt = u_2_vect.';

                        functional_min = functional_cur;

                        switches = t_opt(u_2_vect(1 : (end - 1)) .* u_2_vect(2 : end) < 0);
                    end
                end
            end    

            if (imag(psi_1_cur_2) == 0)
                [t_cur, x_cur] = ode45(@(t, x) odefun_first(t, x, k_1, k_2, alpha, psi_1_cur_2), [0, T], [0, 0, psi_2_0_cur_1]);
                x_1_vect = x_cur(:, 1);
                x_2_vect = x_cur(:, 2);
                psi_2_vect = x_cur(:, 3);
                if (psi_1_cur_2 > 0 && ...
                    psi_2_0_cur_2 >= alpha && ...
                    abs(L - epsilon - x_1_vect(end)) <= delta && ...
                    abs(S + epsilon - x_2_vect(end)) <= delta)

                    u_1_vect = (psi_2_vect > alpha) .* (psi_2_vect - alpha) ./ 2;

                    functional_cur = trapz(t_cur, u_1_vect .^ 2 + alpha .* u_1_vect);

                    if (functional_cur < functional_min)

                        u_2_vect = (psi_1_cur_1 + psi_2_vect .* x_2_vect > 0) .* k_2 + ...
                                   (psi_1_cur_1 + psi_2_vect .* x_2_vect < 0) .* k_1;

                        t_opt = t_cur.';

                        psi1_opt = psi_1_cur_1 .* ones(1, length(t_cur));
                        psi2_opt = psi_2_vect.';

                        x1_opt = x_1_vect.';
                        x2_opt = x_2_vect.';

                        u1_opt = u_1_vect.';
                        u2_opt = u_2_vect.';

                        functional_min = functional_cur;

                        switches = t_opt(u_2_vect(1 : (end - 1)) .* u_2_vect(2 : end) < 0);
                    end
                end
            end
        end
    end
end
try
    u_opt = [u1_opt; u2_opt; t_opt];
    x_opt = [x1_opt; x2_opt; t_opt];
    psi_opt = [psi1_opt; psi2_opt; t_opt];
catch
    u_opt = [];
    x_opt = [];
    psi_opt = [];
    disp('No Solution!');
end
end